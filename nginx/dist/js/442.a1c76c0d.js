"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[442],{6782:function(e,t,n){n.d(t,{Z:function(){return h}});var l=n(73396),a=n(87139);const s=e=>((0,l.dD)("data-v-494cf154"),e=e(),(0,l.Cn)(),e),i={class:"data_box"},o={class:"title"},d=s((()=>(0,l._)("span",{class:"el-icon-plus"},null,-1))),c=s((()=>(0,l._)("span",null,"添加",-1)));function u(e,t,n,s,u,r){const v=(0,l.up)("el-menu-item"),p=(0,l.up)("el-menu"),h=(0,l.up)("el-scrollbar");return(0,l.wg)(),(0,l.iD)("div",i,[(0,l._)("div",o,(0,a.zw)(n.name),1),(0,l.Wm)(h,{height:"calc(100vh - 104px);"},{default:(0,l.w5)((()=>[(0,l.Wm)(p,{"default-active":"1",class:"el-menu-vertical-demo","active-text-color":"#00aa7f","text-color":"#000000",style:{background:"none",border:"none"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(n.datas,(e=>((0,l.wg)(),(0,l.j4)(v,{onClick:t=>r.selectEmit(e.id),index:e.id.toString(),style:{height:"35px","line-height":"35px"}},{default:(0,l.w5)((()=>[(0,l._)("span",{class:(0,a.C_)(n.icon)},null,2),(0,l._)("span",null,(0,a.zw)(e.name),1)])),_:2},1032,["onClick","index"])))),256)),(0,l.Wm)(v,{onClick:r.addEmit,style:{height:"35px","line-height":"35px",color:"#00aaff","font-size":"14px"}},{default:(0,l.w5)((()=>[d,c])),_:1},8,["onClick"])])),_:1})])),_:1})])}var r={props:["datas","name","icon","active"],emits:["select","add"],methods:{selectEmit(e){this.$emit("select",e)},addEmit(){this.$emit("add")}},computed:{activeItem(){if(this.active)return this.active.toString()}}},v=n(40089);const p=(0,v.Z)(r,[["render",u],["__scopeId","data-v-494cf154"]]);var h=p},22355:function(e,t,n){n.r(t),n.d(t,{default:function(){return E}});var l=n(73396),a=n(87139);const s=e=>((0,l.dD)("data-v-16540305"),e=e(),(0,l.Cn)(),e),i={class:"data_box"},o=s((()=>(0,l._)("span",{class:"el-icon-coin"},null,-1))),d=s((()=>(0,l._)("b",null,"基本信息",-1))),c=s((()=>(0,l._)("b",null,"基本配置",-1))),u=s((()=>(0,l._)("b",null,"全局变量",-1))),r={key:0,offset:20,style:{"text-align":"center","margin-top":"5px"}};function v(e,t,n,s,v,p){const h=(0,l.up)("el-tab-pane"),m=(0,l.up)("el-tabs"),f=(0,l.up)("el-button"),g=(0,l.up)("el-menu-item"),b=(0,l.up)("el-menu"),_=(0,l.up)("el-scrollbar"),E=(0,l.up)("el-col"),w=(0,l.up)("el-divider"),I=(0,l.up)("el-input"),k=(0,l.up)("Editor"),y=(0,l.up)("el-empty"),W=(0,l.up)("el-row");return(0,l.wg)(),(0,l.j4)(W,{gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(E,{span:4},{default:(0,l.w5)((()=>[(0,l._)("div",i,[(0,l.Wm)(m,{type:"border-card",stretch:""},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"测试环境"})])),_:1}),(0,l.Wm)(f,{onClick:p.addEnv,type:"success",plain:"",size:"mini",style:{width:"100%"},icon:"el-icon-plus"},{default:(0,l.w5)((()=>[(0,l.Uk)("添加测试环境")])),_:1},8,["onClick"]),(0,l.Wm)(_,{height:"calc(100vh - 124px);"},{default:(0,l.w5)((()=>[(0,l.Wm)(b,{"default-active":v.active,class:"el-menu-vertical-demo","active-text-color":"#409eff","text-color":"#000000",style:{background:"none",border:"none"}},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.testEnvs,(e=>((0,l.wg)(),(0,l.j4)(g,{onClick:t=>p.selectEnv(e),index:e.id.toString(),style:{height:"35px","line-height":"35px"}},{default:(0,l.w5)((()=>[o,(0,l._)("span",null,(0,a.zw)(e.name),1)])),_:2},1032,["onClick","index"])))),256))])),_:1},8,["default-active"])])),_:1})])])),_:1}),v.EnvInfo?((0,l.wg)(),(0,l.j4)(E,{key:0,span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{height:"calc(100vh - 80px )"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{"content-position":"left"},{default:(0,l.w5)((()=>[d])),_:1}),(0,l.Wm)(I,{modelValue:v.EnvInfo.name,"onUpdate:modelValue":t[0]||(t[0]=e=>v.EnvInfo.name=e),placeholder:"环境名称",size:"mini"},{prepend:(0,l.w5)((()=>[(0,l.Uk)(" 环境名 ")])),_:1},8,["modelValue"]),(0,l.Wm)(I,{modelValue:v.EnvInfo.host,"onUpdate:modelValue":t[1]||(t[1]=e=>v.EnvInfo.host=e),placeholder:"hots地址",size:"mini",style:{"margin-top":"5px"}},{prepend:(0,l.w5)((()=>[(0,l.Uk)(" 服务器域名 ")])),_:1},8,["modelValue"]),(0,l.Wm)(w,{"content-position":"left"},{default:(0,l.w5)((()=>[c])),_:1}),(0,l.Wm)(m,{type:"border-card",class:"demo-tabs"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"全局请求头"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:v.EnvInfo.headers,"onUpdate:modelValue":t[2]||(t[2]=e=>v.EnvInfo.headers=e),height:"250px"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(h,{label:"数据库配置"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:v.EnvInfo.db,"onUpdate:modelValue":t[3]||(t[3]=e=>v.EnvInfo.db=e),height:"250px"},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(w,{"content-position":"left"},{default:(0,l.w5)((()=>[u])),_:1}),(0,l.Wm)(m,{type:"border-card",class:"demo-tabs"},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{label:"全局变量"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:v.EnvInfo.global_variable,"onUpdate:modelValue":t[4]||(t[4]=e=>v.EnvInfo.global_variable=e),height:"250px"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(h,{label:"调试运行变量"},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:v.EnvInfo.debug_global_variable,"onUpdate:modelValue":t[5]||(t[5]=e=>v.EnvInfo.debug_global_variable=e),height:"250px"},null,8,["modelValue"])])),_:1})])),_:1}),v.EnvInfo?((0,l.wg)(),(0,l.iD)("div",r,[(0,l.Wm)(f,{onClick:p.saveEnv,type:"success",plain:"",icon:"el-icon-circle-check"},{default:(0,l.w5)((()=>[(0,l.Uk)("保存编辑")])),_:1},8,["onClick"]),(0,l.Wm)(f,{onClick:p.copyEnv,type:"success",plain:"",icon:"el-icon-circle-check"},{default:(0,l.w5)((()=>[(0,l.Uk)("复制环境")])),_:1},8,["onClick"]),(0,l.Wm)(f,{onClick:p.delEnv,type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,l.w5)((()=>[(0,l.Uk)("删除环境")])),_:1},8,["onClick"])])):(0,l.kq)("",!0)])),_:1})])),_:1})):(0,l.kq)("",!0),v.EnvInfo?((0,l.wg)(),(0,l.j4)(E,{key:1,span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(k,{modelValue:v.EnvInfo.global_func,"onUpdate:modelValue":t[6]||(t[6]=e=>v.EnvInfo.global_func=e),height:"calc(100vh - 65px)",lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1})):(0,l.kq)("",!0),0===this.testEnvs.length?((0,l.wg)(),(0,l.j4)(E,{key:2,class:"container",span:20},{default:(0,l.w5)((()=>[(0,l.Wm)(y,null,{default:(0,l.w5)((()=>[(0,l.Wm)(f,{type:"primary",onClick:p.addEnv},{default:(0,l.w5)((()=>[(0,l.Uk)("添加测试环境")])),_:1},8,["onClick"])])),_:1})])),_:1})):(0,l.kq)("",!0)])),_:1})}var p=n(20065),h=n(6782),m=n(62669),f=n(37046),g={components:{DataList:h.Z,Editor:m.Z},data(){return{active:"1",EnvInfo:null}},computed:{...(0,p.rn)(["pro","testEnvs"])},methods:{...(0,p.nv)(["getAllEnvs"]),async addEnv(){const e={project:this.pro.id,name:"New Env"},t=await this.$api.createTestEnvs(e);201===t.status&&(this.$message({type:"success",message:"添加成功",duration:1e3}),this.getAllEnvs())},async delEnv(){f.T$.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const e=await this.$api.delTestEnvs(this.EnvInfo.id);204===e.status&&((0,f.z8)({type:"success",message:"删除成功",duration:1e3}),this.getAllEnvs(),this.testEnvs.length>0&&(this.active=this.testEnvs[0].id.toString(),this.selectEnv(this.testEnvs[0])))})).catch((()=>{(0,f.z8)({type:"info",message:"取消删除",duration:1e3})}))},async saveEnv(){let e={...this.EnvInfo};e.headers=JSON.parse(this.EnvInfo.headers),e.db=JSON.parse(this.EnvInfo.db),e.debug_global_variable=JSON.parse(this.EnvInfo.debug_global_variable),e.global_variable=JSON.parse(this.EnvInfo.global_variable);const t=await this.$api.updateTestEnvs(e.id,e);200===t.status&&(this.$message({type:"success",message:"保存成功",duration:1e3}),this.getAllEnvs())},async copyEnv(){let e={...this.EnvInfo};e.name=e.name+"_COPY",e.headers=JSON.parse(this.EnvInfo.headers),e.db=JSON.parse(this.EnvInfo.db),e.debug_global_variable=JSON.parse(this.EnvInfo.debug_global_variable),e.global_variable=JSON.parse(this.EnvInfo.global_variable);const t=await this.$api.createTestEnvs(e);201===t.status&&(this.$message({type:"success",message:"复制成功",duration:1e3}),this.getAllEnvs())},selectEnv(e){this.active=e.id.toString(),this.EnvInfo={...e},this.EnvInfo.headers=JSON.stringify(this.EnvInfo.headers,null,4),this.EnvInfo.db=JSON.stringify(this.EnvInfo.db,null,4),this.EnvInfo.debug_global_variable=JSON.stringify(this.EnvInfo.debug_global_variable,null,4),this.EnvInfo.global_variable=JSON.stringify(this.EnvInfo.global_variable,null,4)}},created(){this.getAllEnvs()},mounted(){this.testEnvs.length>0&&this.selectEnv(this.testEnvs[0])}},b=n(40089);const _=(0,b.Z)(g,[["render",v],["__scopeId","data-v-16540305"]]);var E=_}}]);
//# sourceMappingURL=442.a1c76c0d.js.map