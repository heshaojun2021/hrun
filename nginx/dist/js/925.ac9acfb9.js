"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[925],{81578:function(e,t,l){l.d(t,{Z:function(){return $}});var a=l(73396),s=l(49242),i=l(87139);const n={key:0},o={key:0},r={key:1},d={key:0,class:"tab-box-sli"},c={style:{color:"#747474"}},u={key:0},p=(0,a._)("b",null,"General",-1),m=(0,a._)("b",null,"Request Headers",-1),w=(0,a._)("b",null,"Request Payload",-1),g={class:"tab-box-sli"},h={key:4,style:{color:"#d60000"}},f={key:0,style:{color:"#00AA7F"}},_={key:1,style:{color:"#d18d17"}},y={key:2,style:{color:"#ff0000"}},k={key:0,style:{color:"#00AA7F"}},b={key:1,style:{color:"#ff5500"}},C={key:0,style:{"margin-top":"10px",width:"100%","text-align":"center"}},W={class:"dialog-footer"};function x(e,t,l,x,v,D){const z=(0,a.up)("Editor"),T=(0,a.up)("el-tab-pane"),I=(0,a.up)("el-tag"),$=(0,a.up)("el-scrollbar"),U=(0,a.up)("el-collapse-item"),V=(0,a.up)("el-collapse"),R=(0,a.up)("el-tabs"),P=(0,a.up)("el-button"),S=(0,a.up)("el-option"),q=(0,a.up)("el-select"),F=(0,a.up)("el-form-item"),j=(0,a.up)("el-input"),A=(0,a.up)("el-form"),L=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(R,{"model-value":"rb",style:{"min-height":"300px"},type:"border-card",value:"rb",size:"mini"},{default:(0,a.w5)((()=>["api"==l.result.type?((0,a.wg)(),(0,a.j4)(T,{key:0,label:"响应体",name:"rb"},{default:(0,a.w5)((()=>[l.result.response_header?((0,a.wg)(),(0,a.iD)("div",n,[-1!=l.result.response_header["Content-Type"].search("application/json")?((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(z,{readOnly:!0,modelValue:l.result.response_body,"onUpdate:modelValue":t[0]||(t[0]=e=>l.result.response_body=e),lang:"json",theme:"chrome"},null,8,["modelValue"])])):((0,a.wg)(),(0,a.iD)("div",r,[(0,a.Wm)(z,{readOnly:!0,modelValue:l.result.response_body,"onUpdate:modelValue":t[1]||(t[1]=e=>l.result.response_body=e),lang:"html",theme:"chrome",height:"500px"},null,8,["modelValue"])]))])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"api"==l.result.type?((0,a.wg)(),(0,a.j4)(T,{key:1,label:"响应头",name:"rh"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{height:"400px",onWheel:t[2]||(t[2]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[l.result.response_header?((0,a.wg)(),(0,a.iD)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.result.response_header,((e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(I,{style:{"margin-top":"3px"},type:"info"},{default:(0,a.w5)((()=>[(0,a._)("b",c,(0,i.zw)(t+" : "),1),(0,a._)("span",null,(0,i.zw)(e),1)])),_:2},1024)])))),256))])):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0),"api"==l.result.type?((0,a.wg)(),(0,a.j4)(T,{key:2,label:"请求信息",name:"rq"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{height:"400px",onWheel:t[4]||(t[4]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[l.result.requests_body?((0,a.wg)(),(0,a.iD)("div",u,[(0,a.Wm)(V,{modelValue:v.activeNames,"onUpdate:modelValue":t[3]||(t[3]=e=>v.activeNames=e),class:"tab-box-sli"},{default:(0,a.w5)((()=>[(0,a.Wm)(U,{name:"1"},{title:(0,a.w5)((()=>[p])),default:(0,a.w5)((()=>[(0,a._)("div",null,"Request Method : "+(0,i.zw)(l.result.method),1),(0,a._)("div",null,"Request URL : "+(0,i.zw)(l.result.url),1)])),_:1}),(0,a.Wm)(U,{name:"2"},{title:(0,a.w5)((()=>[m])),default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.result.requests_header,((e,t)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("span",null,(0,i.zw)(t+" : "+e)+" :",1)])))),256))])),_:1}),(0,a.Wm)(U,{name:"3"},{title:(0,a.w5)((()=>[w])),default:(0,a.w5)((()=>[(0,a._)("span",null,(0,i.zw)(l.result.requests_body),1)])),_:1})])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(T,{label:"日志"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{height:"400px",onWheel:t[5]||(t[5]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(l.result.log_data,((e,t)=>((0,a.wg)(),(0,a.iD)("div",null,["DEBUG"===e[0]?((0,a.wg)(),(0,a.j4)(I,{key:0,style:{"margin-top":"3px"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e[1]),1)])),_:2},1024)):"WARNING"===e[0]?((0,a.wg)(),(0,a.j4)(I,{key:1,style:{"margin-top":"3px"},type:"warning"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e[1]),1)])),_:2},1024)):"ERROR"===e[0]?((0,a.wg)(),(0,a.j4)(I,{key:2,style:{"margin-top":"3px"},type:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e[1]),1)])),_:2},1024)):"INFO"===e[0]?((0,a.wg)(),(0,a.j4)(I,{key:3,style:{"margin-top":"3px"},type:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(e[1]),1)])),_:2},1024)):"EXCEPT"===e[0]?((0,a.wg)(),(0,a.iD)("pre",h,(0,i.zw)(e[1]),1)):(0,a.kq)("",!0)])))),256))])])),_:1})])),_:1}),(0,a.Wm)(T,{disabled:""},{label:(0,a.w5)((()=>["成功"===l.result.state?((0,a.wg)(),(0,a.iD)("span",f,(0,i.zw)("Assert : "+l.result.state),1)):"失败"===l.result.state?((0,a.wg)(),(0,a.iD)("span",_,(0,i.zw)("Assert : "+l.result.state),1)):((0,a.wg)(),(0,a.iD)("span",y,(0,i.zw)(l.result.state),1))])),_:1}),"api"==l.result.type?((0,a.wg)(),(0,a.j4)(T,{key:3,disabled:""},{label:(0,a.w5)((()=>[l.result.status_cede<=300?((0,a.wg)(),(0,a.iD)("span",k,(0,i.zw)("Status : "+l.result.status_cede),1)):((0,a.wg)(),(0,a.iD)("span",b,(0,i.zw)("Status : "+l.result.status_cede),1))])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(T,{disabled:""},{label:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)("Time : "+l.result.run_time),1)])),_:1})])),_:1}),"失败"===l.result.state&&l.showbtn?((0,a.wg)(),(0,a.iD)("div",C,[(0,a.Wm)(P,{onClick:D.getInterfaces,type:"success",plain:"",size:"mini"},{default:(0,a.w5)((()=>[(0,a.Uk)("提交bug")])),_:1},8,["onClick"])])):(0,a.kq)("",!0),(0,a.Wm)(L,{title:"提交bug",modelValue:v.addBugDlg,"onUpdate:modelValue":t[8]||(t[8]=e=>v.addBugDlg=e),width:"40%","before-close":D.closeDialogResult},{footer:(0,a.w5)((()=>[(0,a._)("div",W,[(0,a.Wm)(P,{onClick:D.closeDialogResult},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1},8,["onClick"]),(0,a.Wm)(P,{type:"success",onClick:D.saveBug},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(A,{model:v.bugForm},{default:(0,a.w5)((()=>[(0,a.Wm)(F,{label:"所属接口"},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{size:"small",modelValue:v.bugForm.interface,"onUpdate:modelValue":t[6]||(t[6]=e=>v.bugForm.interface=e),placeholder:"bug对应的接口",style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.interfaces,(e=>((0,a.wg)(),(0,a.j4)(S,{label:e.name+" "+e.url,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(F,{label:"bug描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{autosize:{minRows:3,maxRows:4},modelValue:v.bugForm.desc,"onUpdate:modelValue":t[7]||(t[7]=e=>v.bugForm.desc=e),type:"textarea",autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"])],64)}var v=l(62669),D=l(20065),z={props:{result:{default:{}},showbtn:{default:!0}},computed:{...(0,D.rn)(["pro"])},components:{Editor:v.Z},data(){return{activeNames:["1","2","3"],addBugDlg:!1,bugForm:{interface:null,desc:"",info:"",status:"待处理"},interfaces:[]}},methods:{async saveBug(){this.bugForm.project=this.pro.id,this.bugForm.info=this.result;const e=await this.$api.createBugs(this.bugForm);201===e.status&&(this.$message({type:"success",message:"bug提交成功",duration:1e3}),this.addBugDlg=!1,this.bugForm={interface:null,desc:"",info:"",status:"待处理"})},closeDialogResult(){this.addBugDlg=!1,this.bugForm={interface:null,desc:"",info:"",status:"待处理"}},async getInterfaces(){const e=await this.$api.getnewInterfaces();200===e.status&&(this.interfaces=e.data,this.addBugDlg=!0)}}},T=l(40089);const I=(0,T.Z)(z,[["render",x]]);var $=I},12609:function(e,t,l){l.r(t),l.d(t,{default:function(){return ae}});l(70560);var a=l(73396),s=l(87139),i=l(49242);const n=e=>((0,a.dD)("data-v-07b503bc"),e=e(),(0,a.Cn)(),e),o={class:"tree-component"},r={class:"bold-node"},d={class:"node-content"},c=["onClick"],u=["onClick"],p={style:{display:"flex","justify-content":"space-between","margin-left":"10px","margin-right":"26px"}},m={style:{display:"flex","flex-wrap":"wrap","margin-top":"30px"}},w=["onClick"],g=["onClick"],h={style:{display:"flex","align-items":"center"}},f={class:"text-16px"},_={class:"message"},y={class:"projectinfo_user_time"},k={ref:"chartTable",class:"char_box1"},b=n((()=>(0,a._)("b",null,"近三天执行记录",-1))),C={key:0},W={key:0},x={key:0},v={key:0},D={class:"dialog-footer"};function z(e,t,l,n,z,T){const I=(0,a.up)("el-button"),$=(0,a.up)("el-input"),U=(0,a.up)("el-scrollbar"),V=(0,a.up)("Edit"),R=(0,a.up)("el-icon"),P=(0,a.up)("Delete"),S=(0,a.up)("el-tree"),q=(0,a.up)("el-col"),F=(0,a.up)("el-empty"),j=(0,a.up)("icon"),A=(0,a.up)("el-card"),L=(0,a.up)("el-divider"),B=(0,a.up)("el-table-column"),M=(0,a.up)("el-tag"),N=(0,a.up)("el-table"),E=(0,a.up)("el-row"),H=(0,a.up)("el-form-item"),Y=(0,a.up)("el-form"),O=(0,a.up)("el-dialog"),Z=(0,a.up)("TestCase");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(E,{gutter:10},{default:(0,a.w5)((()=>[(0,a.Wm)(q,{span:5},{default:(0,a.w5)((()=>[(0,a._)("div",o,[(0,a.Wm)($,{modelValue:z.filterText,"onUpdate:modelValue":t[0]||(t[0]=e=>z.filterText=e),placeholder:"请输入计划名称进行搜索",clearable:""},{append:(0,a.w5)((()=>[(0,a.Wm)(I,{type:"primary",onClick:T.handletreeClick},{default:(0,a.w5)((()=>[(0,a.Uk)("查询")])),_:1},8,["onClick"])])),_:1},8,["modelValue"]),(0,a.Wm)(I,{type:"primary",style:{"margin-bottom":"5px","margin-top":"10px"},onClick:T.addPlan,icon:"el-icon-plus"},{default:(0,a.w5)((()=>[(0,a.Uk)("添加计划")])),_:1},8,["onClick"]),(0,a.Wm)(U,{height:"calc(100vh - 150px)"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{class:"filter-tree",data:z.planList,props:T.defaultProps,"default-expand-all":"","expand-on-click-node":!1,onNodeClick:T.handleNodeClick},{default:(0,a.w5)((({node:e,data:t})=>[(0,a.Wm)(U,null,{default:(0,a.w5)((()=>[(0,a._)("span",r,(0,s.zw)(e.label),1)])),_:2},1024),(0,a._)("div",d,[(0,a._)("span",null,[(0,a._)("a",{onClick:t=>T.clickPlan(e.data)},[(0,a.Wm)(R,{style:{color:"#0d84ff"}},{default:(0,a.w5)((()=>[(0,a.Wm)(V)])),_:1})],8,c),(0,a._)("a",{onClick:t=>T.delPlan(e.data.id)},[(0,a.Wm)(R,{style:{color:"#0d84ff","margin-right":"20px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(P)])),_:1})],8,u)])])])),_:1},8,["data","props","onNodeClick"])])),_:1})])])),_:1}),(0,a.Wm)(q,{span:10,style:{"margin-top":"10px"}},{default:(0,a.w5)((()=>[(0,a._)("span",p,[(0,a.Wm)(I,{type:"primary",style:{"margin-bottom":"5px","margin-top":"10px"},onClick:T.clickAddScene,icon:"el-icon-plus"},{default:(0,a.w5)((()=>[(0,a.Uk)("添加场景 ")])),_:1},8,["onClick"]),(0,a.Wm)(I,{type:"primary",style:{"margin-bottom":"5px","margin-top":"10px"},onClick:T.runPlan,icon:"el-icon-s-promotion"},{default:(0,a.w5)((()=>[(0,a.Uk)("运行 ")])),_:1},8,["onClick"])]),0===z.scene_list.length?((0,a.wg)(),(0,a.j4)(F,{key:0,description:"暂无数据请添加测试场景"})):(0,a.kq)("",!0),(0,a.Wm)(U,{height:"calc(100vh - 115px)"},{default:(0,a.w5)((()=>[(0,a._)("div",m,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(z.scene_list,((e,l)=>((0,a.wg)(),(0,a.j4)(A,{key:e.id,class:"custom-card",style:{flex:"0 0 calc(30.5%)",margin:"5px",cursor:"pointer"},shadow:"hover"},{default:(0,a.w5)((()=>[(0,a._)("div",{onClick:t=>T.clickView(e)},[(0,a._)("i",{onClick:[t[1]||(t[1]=(0,i.iM)((()=>{}),["stop"])),t=>T.delScene(e.id)],class:"el-icon-delete",style:{display:"flex",float:"right","margin-top":"-10px","margin-right":"-10px",color:"#7e8bec"}},null,8,g),(0,a._)("div",h,[(0,a.Wm)(j,{icon:"line-md:star-pulsating-loop","font-size":"25",style:{"margin-right":"5px",color:"#7e8bec"}}),(0,a._)("span",f,(0,s.zw)(e.name),1)]),(0,a._)("div",_,(0,s.zw)(e.desc),1),(0,a._)("div",y,[(0,a._)("span",null,"步骤数："+(0,s.zw)(e.stepCount),1),(0,a._)("span",null,"场景"+(0,s.zw)(l+1),1)])],8,w)])),_:2},1024)))),128))])])),_:1})])),_:1}),(0,a.Wm)(q,{span:9},{default:(0,a.w5)((()=>[(0,a._)("div",k,null,512),(0,a.Wm)(L,{"content-position":"left"},{default:(0,a.w5)((()=>[b])),_:1}),(0,a.Wm)(U,{height:"calc(100vh - 380px)"},{default:(0,a.w5)((()=>[(0,a.Wm)(N,{data:z.records,class:"table-style",size:"mini","empty-text":"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(B,{prop:"create_time",label:"执行时间","min-width":"140",align:"center"},{default:(0,a.w5)((t=>[(0,a.Uk)((0,s.zw)(e.$tools.rTime(t.row.create_time)),1)])),_:1}),(0,a.Wm)(B,{prop:"env_name",label:"测试环境","min-width":"110",align:"center"}),(0,a.Wm)(B,{prop:"all",label:"总用例","min-width":"50",align:"center"},{default:(0,a.w5)((e=>["执行中"!==e.row.status?((0,a.wg)(),(0,a.iD)("span",C,(0,s.zw)(e.row.all),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(B,{label:"通过数","min-width":"50",align:"center"},{default:(0,a.w5)((e=>["执行中"!==e.row.status?((0,a.wg)(),(0,a.iD)("span",W,(0,s.zw)(e.row.success),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(B,{label:"通过率","min-width":"80",align:"center"},{default:(0,a.w5)((e=>["执行中"!==e.row.status?((0,a.wg)(),(0,a.iD)("span",x,(0,s.zw)(e.row.pass_rate+"%"),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(B,{label:"测试报告",width:"100",align:"center"},{default:(0,a.w5)((t=>["执行中"===t.row.status?((0,a.wg)(),(0,a.iD)("span",v,[(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(t.row.status),1)])),_:2},1024)])):((0,a.wg)(),(0,a.j4)(I,{key:1,type:"success",icon:"el-icon-view",plain:"",size:"mini",onClick:l=>e.$router.push({name:"report",params:{id:t.row.id}})},{default:(0,a.w5)((()=>[(0,a.Uk)(" 查看 ")])),_:2},1032,["onClick"]))])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1}),(0,a.Wm)(O,{modelValue:z.editDlg,"onUpdate:modelValue":t[3]||(t[3]=e=>z.editDlg=e),title:"修改计划",width:"20%","before-close":T.clickClear},{footer:(0,a.w5)((()=>[(0,a._)("span",D,[(0,a.Wm)(I,{onClick:T.clickClear},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1},8,["onClick"]),(0,a.Wm)(I,{type:"primary",onClick:T.savePlan},{default:(0,a.w5)((()=>[(0,a.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(Y,{model:z.planForm,ref:"treeRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{label:"计划名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)($,{modelValue:z.planForm.name,"onUpdate:modelValue":t[2]||(t[2]=e=>z.planForm.name=e),autocomplete:"off",placeholder:"请输入计划名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"]),z.sceneDlg?((0,a.wg)(),(0,a.j4)(Z,{key:0,onCloseModal:T.handleCloseModal,planId:z.planId},null,8,["onCloseModal","planId"])):(0,a.kq)("",!0)],64)}var T=l(37046),I=l(20065),$=l(76088);const U=e=>((0,a.dD)("data-v-7916fd9e"),e=e(),(0,a.Cn)(),e),V={style:{"margin-left":"20px"}},R={style:{"margin-top":"15px","margin-right":"20px"}},P={key:0},S={key:1},q={key:0},F={class:"pagination-container"},j={style:{padding:"20px"}},A={style:{color:"#00aaff"}},L={style:{color:"#00aa7f"}},B={style:{color:"orangered"}},M={style:{color:"#fca130"}},N=U((()=>(0,a._)("div",{style:{height:"40px","line-height":"40px"}},[(0,a._)("b",null,"执行详情")],-1))),E={key:0},H={key:0},Y={key:0,style:{color:"#00AA7F"}},O={key:1,style:{color:"#fca130"}},Z={key:2,style:{color:"#F56C6C"}};function K(e,t,l,i,n,o){const r=(0,a.up)("el-button"),d=(0,a.up)("el-input"),c=(0,a.up)("el-table-column"),u=(0,a.up)("router-link"),p=(0,a.up)("el-tooltip"),m=(0,a.up)("el-table"),w=(0,a.up)("el-pagination"),g=(0,a.up)("el-scrollbar"),h=(0,a.up)("el-dialog"),f=(0,a.up)("el-descriptions-item"),_=(0,a.up)("el-descriptions"),y=(0,a.up)("caseResult"),k=(0,a.up)("el-drawer");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(h,{modelValue:n.sceneDlg,"onUpdate:modelValue":t[1]||(t[1]=e=>n.sceneDlg=e),title:"添加场景",width:"75%","before-close":o.clickClear,top:"0"},{default:(0,a.w5)((()=>[(0,a._)("div",V,[(0,a._)("div",null,[(0,a.Wm)(d,{style:{width:"330px"},modelValue:n.filterText,"onUpdate:modelValue":t[0]||(t[0]=e=>n.filterText=e),placeholder:"请输入用例名称进行搜索",clearable:""},{append:(0,a.w5)((()=>[(0,a.Wm)(r,{type:"primary",onClick:o.searchClick},{default:(0,a.w5)((()=>[(0,a.Uk)("查询")])),_:1},8,["onClick"])])),_:1},8,["modelValue"]),(0,a._)("span",null,[(0,a.Wm)(r,{type:"warning",style:{float:"right","margin-right":"19px"},onClick:o.clickClear,icon:"el-icon-close"},{default:(0,a.w5)((()=>[(0,a.Uk)("关闭窗口 ")])),_:1},8,["onClick"]),(0,a.Wm)(r,{type:"primary",style:{float:"right","margin-right":"15px"},onClick:o.addScentToPlan,icon:"el-icon-check"},{default:(0,a.w5)((()=>[(0,a.Uk)("确认选择 ")])),_:1},8,["onClick"])])]),(0,a.Wm)(g,{height:"calc(100vh - 110px)"},{default:(0,a.w5)((()=>[(0,a._)("div",R,[(0,a.Wm)(m,{data:n.caseList,stripe:"","empty-text":"暂无数据",border:"",onSelectionChange:o.handleSelectionChange},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"selection",align:"center",width:"50"}),(0,a.Wm)(c,{label:"序号",align:"center",width:"60"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,s.zw)(e.$index+1),1)])),_:1}),(0,a.Wm)(c,{label:"用例名称",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(u,{class:"no-underline",to:"/TestCaseDetail/",style:{color:"#409eff"},onClick:t=>o.clickEdit(e.row)},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.row.name),1)])),_:2},1032,["onClick"])])),_:1}),(0,a.Wm)(c,{label:"所属项目",prop:"project.name",align:"center"}),(0,a.Wm)(c,{label:"步骤数",width:"70",prop:"stepCount",align:"center"}),(0,a.Wm)(c,{label:"用例描述",prop:"desc",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(p,{class:"item",effect:"dark",content:e.row.desc,placement:"top"},{default:(0,a.w5)((()=>[e.row.desc.length>16?((0,a.wg)(),(0,a.iD)("div",P,(0,s.zw)(e.row.desc.slice(0,16))+"...",1)):((0,a.wg)(),(0,a.iD)("div",S,(0,s.zw)(e.row.desc),1))])),_:2},1032,["content"])])),_:1}),(0,a.Wm)(c,{label:"创建人",prop:"creator",align:"center",width:"120"}),(0,a.Wm)(c,{label:"创建时间",align:"center",width:"160"},{default:(0,a.w5)((t=>[(0,a.Uk)((0,s.zw)(e.$tools.rTime(t.row.create_time)),1)])),_:1}),(0,a.Wm)(c,{label:"更新人",prop:"modifier",align:"center",width:"120"}),(0,a.Wm)(c,{label:"更新时间",align:"center",width:"160"},{default:(0,a.w5)((t=>[t.row.update_time?((0,a.wg)(),(0,a.iD)("a",q,(0,s.zw)(e.$tools.rTime(t.row.update_time)),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(c,{label:"操作",width:"330",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(r,{onClick:t=>o.runCase(e.row),size:"mini",type:"primary",icon:"el-icon-s-promotion"},{default:(0,a.w5)((()=>[(0,a.Uk)("运行")])),_:2},1032,["onClick"]),(0,a.Wm)(r,{onClick:t=>o.clickEdit(e.row),size:"mini",type:"warning",icon:"el-icon-menu"},{default:(0,a.w5)((()=>[(0,a.Uk)("添加管理步骤")])),_:2},1032,["onClick"]),(0,a.Wm)(r,{onClick:t=>o.delCase(e.row.id),size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data","onSelectionChange"])]),(0,a._)("div",F,[(0,a.Wm)(w,{background:"",layout:"total, prev, pager, next, jumper",onCurrentChange:o.currentPages,"default-page-size":100,total:n.pages.count,"current-page":n.pages.current,"next-text":"下一页","prev-text":"上一页"},null,8,["onCurrentChange","total","current-page"])])])),_:1})])])),_:1},8,["modelValue","before-close"]),(0,a.Wm)(k,{modelValue:n.ResultDlg,"onUpdate:modelValue":t[2]||(t[2]=e=>n.ResultDlg=e),"with-header":!1,size:"50%"},{default:(0,a.w5)((()=>[(0,a._)("div",j,[(0,a.Wm)(_,{title:"执行结果",border:"",column:4,style:{"text-align":"center"}},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"总数"},{default:(0,a.w5)((()=>[(0,a._)("b",A,(0,s.zw)(n.runScentResult.all),1)])),_:1}),(0,a.Wm)(f,{label:"通过"},{default:(0,a.w5)((()=>[(0,a._)("b",L,(0,s.zw)(n.runScentResult.success),1)])),_:1}),(0,a.Wm)(f,{label:"失败"},{default:(0,a.w5)((()=>[(0,a._)("b",B,(0,s.zw)(n.runScentResult.fail),1)])),_:1}),(0,a.Wm)(f,{label:"错误"},{default:(0,a.w5)((()=>[(0,a._)("b",M,(0,s.zw)(n.runScentResult.error),1)])),_:1})])),_:1}),N,(0,a.Wm)(g,{height:"calc(100vh - 180px)"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{data:n.runScentResult.cases,style:{width:"100%"},"empty-text":"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(c,{type:"expand"},{default:(0,a.w5)((e=>[(0,a.Wm)(y,{result:e.row},null,8,["result"])])),_:1}),(0,a.Wm)(c,{label:"步骤名",prop:"name"}),(0,a.Wm)(c,{label:"请求方法",prop:"method"},{default:(0,a.w5)((e=>["api"===e.row.type?((0,a.wg)(),(0,a.iD)("span",E,(0,s.zw)(e.row.method),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(c,{label:"响应状态码",prop:"status_cede"},{default:(0,a.w5)((e=>["api"===e.row.type?((0,a.wg)(),(0,a.iD)("span",H,(0,s.zw)(e.row.status_cede),1)):(0,a.kq)("",!0)])),_:1}),(0,a.Wm)(c,{label:"执行结果",prop:"state","min-width":"40px"},{default:(0,a.w5)((e=>["成功"==e.row.state?((0,a.wg)(),(0,a.iD)("span",Y,(0,s.zw)(e.row.state),1)):"错误"==e.row.state?((0,a.wg)(),(0,a.iD)("span",O,(0,s.zw)(e.row.state),1)):((0,a.wg)(),(0,a.iD)("span",Z,(0,s.zw)(e.row.state),1))])),_:1})])),_:1},8,["data"])])),_:1})])])),_:1},8,["modelValue"])],64)}var G=l(81578),J={props:{planId:String},computed:{...(0,I.rn)(["pro","envId"])},components:{caseResult:G.Z},data(){return{filterText:"",pages:[],caseList:[],ResultDlg:!1,runScentResult:"",sceneDlg:!0,selectedRows:[]}},methods:{...(0,I.OI)(["CaseInfo"]),searchClick(){this.allTestCase(this.pro.id,this.pages.current,this.filterText)},clickEdit(e){this.$router.push({name:"TestCaseDetail"}),this.CaseInfo(e)},async allTestCase(e,t,l){const a=await this.$api.getTestCase(e,t,l);if(200===a.status){const e=a.data.result;this.pages=a.data;const t=await this.$api.getTestCase_({testplan:this.planId});if(200===t.status){const l=t.data.result;this.caseList=e.filter((e=>!l.map((e=>e.id)).includes(e.id))),this.caseList=this.caseList.filter((e=>0!==e.stepCount)),this.pages.count=this.caseList.length}}},currentPages(e){this.allTestCase(this.pro.id,e),this.pages.current=e},delCase(e){this.$confirm("此操作将永久删除该用例, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await this.$api.delTestCase(e);204===t.status&&(this.$message({type:"success",message:"删除成功!"}),this.allTestCase(this.pro.id),this.filterText="")})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async runCase(e){const t=parseInt(e.stepCount);if(console.log(t),t>0)if(this.envId){const t={env:this.envId,scene:e.id};(0,T.bM)({title:"开始运行",message:"运行过程中请稍等片刻噢",type:"success",duration:1e3});const l=await this.$api.runCases(e.id,t);200==l.status&&(this.runScentResult=l.data,this.ResultDlg=!0)}else this.$message({type:"warning",message:"当前未选中执行环境!",duration:1e3});else this.$message({type:"warning",message:"请添加步骤后再运行",duration:1e3})},closeModal(){this.$emit("close-modal")},clickClear(){this.closeModal()},async addScentToPlan(){if(0===this.selectedRows.length)return void this.$message({type:"warning",message:"请勾选要添加的测试场景",duration:1e3});let e={};e.scene_ids=[...this.selectedRows];const t=await this.$api.createTestPlan_scene(this.planId,e);200===t.status&&this.$message({type:"success",message:"添加成功",duration:1e3}),this.closeModal()},handleSelectionChange(e){this.selectedRows=e.map((e=>e.id)),console.log(this.selectedRows)}},created(){this.allTestCase(this.pro.id)}},X=l(40089);const Q=(0,X.Z)(J,[["render",K],["__scopeId","data-v-7916fd9e"]]);var ee=Q,te={components:{Icon:$.JO,TestCase:ee},data(){return{planList:[],planInfo:null,active:"1",scents:[],records:[],drawer:!1,addScentList:[],planForm:{name:""},filterText:"",editDlg:!1,scene_list:"",checkList:"",sceneDlg:!1,planId:""}},computed:{...(0,I.rn)(["pro","envId"]),defaultProps(){return{children:"children",label:"name"}},chartData:function(){let e=[],t=[];for(let l of this.records)e.push(this.$tools.rTime(l.create_time)),t.push(parseFloat(l.pass_rate).toFixed(2));return{label:e.reverse(),value:t}}},methods:{...(0,I.OI)(["CaseInfo"]),async getAllPlan(e){if(e){const t=await this.$api.getTestPlan(this.pro.id,e);200===t.status&&(this.planList=t.data),this.planList.length>0&&(this.planId=this.planList[0].id,this.getScenes(this.planList[0].id))}else{const e=await this.$api.getTestPlan(this.pro.id);200===e.status&&(this.planList=e.data),this.planList.length>0&&(this.planId=this.planList[0].id,this.getScenes(this.planList[0].id))}},async getAllRecord(){const e=await this.$api.getTestRecord({plan:this.planId,project:this.pro.id});200==e.status&&(this.records=e.data)},async addPlan(){const e={project:this.pro.id,name:"New Plan"},t=await this.$api.createTestPlan(e);201===t.status&&(this.$message({type:"success",message:"添加成功",duration:1e3}),this.getAllPlan())},handleNodeClick(e){this.planId=e.id,this.getScenes(this.planId)},async getScenes(e){const t=await this.$api.getTestCase_({testplan:e});200==t.status&&(this.scene_list=t.data.result),this.getAllRecord()},handletreeClick(){this.getAllPlan(this.filterText)},clickClear(){this.editDlg=!1},clickPlan(e){this.editDlg=!0,this.planForm={...e}},async savePlan(){const e=await this.$api.updateTestPlan(this.planForm.id,this.planForm);200===e.status&&(this.$message({type:"success",message:"保存成功",duration:1e3}),this.editDlg=!1,this.getAllPlan())},async runPlan(){if(this.envId){const e={env:this.envId,plan:this.planId,types:2};(0,T.bM)({title:"开始运行",message:"运行过程中请稍等片刻噢",type:"success",duration:3e3});const t=await this.$api.runPlan(this.planId,e);200===t.status&&this.getAllRecord()}else this.$message({type:"warning",message:"当前未选中执行环境!",duration:1e3})},delPlan(e){T.T$.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const t=await this.$api.delTestPlan(e);204===t.status&&((0,T.z8)({type:"success",message:"删除成功",duration:1e3}),this.getAllPlan())})).catch((()=>{(0,T.z8)({type:"info",message:"取消删除",duration:1e3})}))},clickView(e){this.$router.push({name:"TestCaseDetail"}),e.back_type="plan",this.CaseInfo(e)},async delScene(e){let t={scene_id:e};const l=await this.$api.delTestPlan_scene(this.planId,t);200===l.status&&(this.$message({type:"success",message:"删除成功",duration:1e3}),this.getScenes(this.planId))},clickAddScene(){this.sceneDlg=!0},handleCloseModal(){console.log("我被触发了",this.planId),this.sceneDlg=!1,this.getScenes(this.planId)}},created(){this.getAllPlan()},watch:{records(){this.$chart.chart3(this.$refs.chartTable,this.chartData.value,this.chartData.label)}}};const le=(0,X.Z)(te,[["render",z],["__scopeId","data-v-07b503bc"]]);var ae=le}}]);
//# sourceMappingURL=925.ac9acfb9.js.map