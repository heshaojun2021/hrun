"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[422],{80422:function(e,l,a){a.r(l),a.d(l,{default:function(){return b}});var t=a(73396),o=a(87139);const s={class:"box"},r={class:"query_model"},d={class:"buttons"},i={class:"dialog-footer"},n={class:"dialog-footer"},m={class:"dialog-footer"},u={class:"table_data"},c={key:0},p={class:"pagination-container"};function h(e,l,a,h,g,w){const f=(0,t.up)("el-input"),_=(0,t.up)("el-button"),b=(0,t.up)("el-form-item"),y=(0,t.up)("el-option"),U=(0,t.up)("el-select"),V=(0,t.up)("el-form"),C=(0,t.up)("el-dialog"),k=(0,t.up)("el-table-column"),W=(0,t.up)("el-table"),x=(0,t.up)("el-pagination"),F=(0,t.up)("el-scrollbar");return(0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(F,{height:"calc(100vh - 80px)"},{default:(0,t.w5)((()=>[(0,t._)("div",r,[(0,t._)("span",null,[(0,t.Uk)("用户名 "),(0,t.Wm)(f,{modelValue:g.QueryCondition.username,"onUpdate:modelValue":l[0]||(l[0]=e=>g.QueryCondition.username=e),placeholder:"请输入用户名",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("手机号 "),(0,t.Wm)(f,{modelValue:g.QueryCondition.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>g.QueryCondition.mobile=e),placeholder:"请输入手机号码",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("邮箱 "),(0,t.Wm)(f,{modelValue:g.QueryCondition.email,"onUpdate:modelValue":l[2]||(l[2]=e=>g.QueryCondition.email=e),placeholder:"请输入邮箱",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("所属项目 "),(0,t.Wm)(f,{modelValue:g.QueryCondition.project_name,"onUpdate:modelValue":l[3]||(l[3]=e=>g.QueryCondition.project_name=e),placeholder:"请输入项目名称",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",d,[(0,t.Wm)(_,{onClick:w.resetForm,icon:"el-icon-refresh"},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1},8,["onClick"]),(0,t.Wm)(_,{type:"primary",onClick:w.submitForm,icon:"el-icon-refresh"},{default:(0,t.w5)((()=>[(0,t.Uk)(" 查询")])),_:1},8,["onClick"])])]),(0,t.Wm)(_,{onClick:w.clickAdd,plain:"",type:"success",icon:"el-icon-plus",style:{"margin-bottom":"5px","margin-left":"10px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("新增")])),_:1},8,["onClick"]),(0,t.Wm)(_,{onClick:w.clickAddPro,plain:"",type:"primary",icon:"el-icon-plus",style:{"margin-bottom":"5px","margin-left":"10px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("添加其他项目成员")])),_:1},8,["onClick"]),(0,t.Wm)(C,{modelValue:g.addProDlg,"onUpdate:modelValue":l[6]||(l[6]=e=>g.addProDlg=e),title:"添加其他项目成员",width:"30%","custom-class":"class_dialog",required:!0,style:{"text-align":"left"},"before-close":w.clearValidation},{footer:(0,t.w5)((()=>[(0,t._)("span",i,[(0,t.Wm)(_,{onClick:w.clearValidation,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(_,{type:"primary",onClick:w.clickExcludeUser,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{model:g.addProForm,rules:g.rulesUser,ref:"UserRef","label-width":"80px",style:{"max-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{label:"所属项目",required:!0,style:{"text-align":"left"}},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addProForm.project_name,"onUpdate:modelValue":l[4]||(l[4]=e=>g.addProForm.project_name=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"选择用户"},{default:(0,t.w5)((()=>[(0,t.Wm)(U,{multiple:"",modelValue:g.addProForm.users,"onUpdate:modelValue":l[5]||(l[5]=e=>g.addProForm.users=e),filterable:"",placeholder:"请选择用户",style:{width:"100%"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(g.usersExclude,(e=>((0,t.wg)(),(0,t.j4)(y,{value:e.id,label:e.username,key:e.id},null,8,["value","label"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(C,{modelValue:g.addDlg,"onUpdate:modelValue":l[13]||(l[13]=e=>g.addDlg=e),title:"新增用户",width:"30%","custom-class":"class_dialog",required:!0,style:{"text-align":"left"},"before-close":w.clearValidation},{footer:(0,t.w5)((()=>[(0,t._)("span",n,[(0,t.Wm)(_,{onClick:w.clearValidation,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(_,{type:"primary",onClick:w.AddInter,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{model:g.addForm,rules:g.rulesUser,ref:"UserRef","label-width":"80px",style:{"max-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{prop:"username",label:"用户名"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.username,"onUpdate:modelValue":l[7]||(l[7]=e=>g.addForm.username=e),maxlength:"18",minlength:"3",placeholder:"请输入用户名","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"标签"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.weChat_name,"onUpdate:modelValue":l[8]||(l[8]=e=>g.addForm.weChat_name=e),maxlength:"50",minlength:"1",placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"手机号码",prop:"mobile"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.mobile,"onUpdate:modelValue":l[9]||(l[9]=e=>g.addForm.mobile=e),maxlength:"11",minlength:"11",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"邮箱地址"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.email,"onUpdate:modelValue":l[10]||(l[10]=e=>g.addForm.email=e),placeholder:"请输入邮箱地址",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"所属项目",required:!0,style:{"text-align":"left"}},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.project_name,"onUpdate:modelValue":l[11]||(l[11]=e=>g.addForm.project_name=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{clearable:"",readonly:g.readonlyInput,label:"密码",prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.addForm.password,"onUpdate:modelValue":l[12]||(l[12]=e=>g.addForm.password=e),type:"password","show-password":"",maxlength:"18",minlength:"3",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1},8,["readonly"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(C,{modelValue:g.editDlg,"onUpdate:modelValue":l[20]||(l[20]=e=>g.editDlg=e),title:"修改用户",width:"30%","custom-class":"class_dialog",required:!0,style:{"text-align":"left"},"before-close":w.clearValidation},{footer:(0,t.w5)((()=>[(0,t._)("span",m,[(0,t.Wm)(_,{type:"primary",onClick:w.resetPassword},{default:(0,t.w5)((()=>[(0,t.Uk)("重置密码")])),_:1},8,["onClick"]),(0,t.Wm)(_,{type:"primary",onClick:w.UpdateInter},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"]),(0,t.Wm)(_,{onClick:w.clearValidation},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{model:g.editForm,rules:g.rulesUser,ref:"UserRef","label-width":"80px",style:{"max-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{prop:"username",label:"用户名"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.username,"onUpdate:modelValue":l[14]||(l[14]=e=>g.editForm.username=e),maxlength:"18",minlength:"3",placeholder:"请输入用户名",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"标签"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.weChat_name,"onUpdate:modelValue":l[15]||(l[15]=e=>g.editForm.weChat_name=e),maxlength:"50",minlength:"1",placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"手机号码",prop:"mobile"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.mobile,"onUpdate:modelValue":l[16]||(l[16]=e=>g.editForm.mobile=e),maxlength:"11",minlength:"11",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"邮箱地址"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.email,"onUpdate:modelValue":l[17]||(l[17]=e=>g.editForm.email=e),placeholder:"请输入邮箱地址",maxlength:"30",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"所属项目",required:!0,style:{"text-align":"left"}},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.project_name,"onUpdate:modelValue":l[18]||(l[18]=e=>g.editForm.project_name=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),g.showResetPassword?((0,t.wg)(),(0,t.j4)(b,{key:0,label:"新密码",prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{modelValue:g.editForm.password,"onUpdate:modelValue":l[19]||(l[19]=e=>g.editForm.password=e),type:"password","show-password":"",maxlength:"18",minlength:"3",placeholder:"请输入密码",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1})):(0,t.kq)("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,t._)("div",u,[(0,t.Wm)(W,{data:g.UserLsit,stripe:"","empty-text":"暂无数据"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{label:"序号",align:"center",width:"60"},{default:(0,t.w5)((e=>[(0,t._)("span",null,(0,o.zw)(e.$index+1),1)])),_:1}),(0,t.Wm)(k,{label:"用户名",prop:"username",align:"center"}),(0,t.Wm)(k,{label:"标签",prop:"weChat_name",align:"center"}),(0,t.Wm)(k,{label:"手机号码",prop:"mobile",align:"center"}),(0,t.Wm)(k,{label:"邮箱",prop:"email",align:"center"}),(0,t.Wm)(k,{label:"所属项目","show-overflow-tooltip":"",align:"center"},{default:(0,t.w5)((e=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.project,((l,a)=>((0,t.wg)(),(0,t.iD)("span",{key:a},[(0,t.Uk)((0,o.zw)(l.name)+" ",1),a!==e.row.project.length-1?((0,t.wg)(),(0,t.iD)("span",c,", ")):(0,t.kq)("",!0)])))),128))])),_:1}),(0,t.Wm)(k,{label:"操作",width:"180",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(_,{onClick:l=>w.clickEdit(e.row),size:"mini",plain:"",type:"primary",icon:"el-icon-edit-outline"},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(_,{onClick:l=>w.delUser(e.row.id),size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,t._)("div",p,[(0,t.Wm)(x,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,30,50,100],onSizeChange:w.sizes,onCurrentChange:w.currentPages,total:g.Pager.count,"current-page":g.Pager.current,"next-text":"下一页","prev-text":"上一页"},null,8,["onSizeChange","onCurrentChange","total","current-page"])])])),_:1})])}a(70560);var g=a(20065),w={data(){return{UserLsit:"",QueryCondition:{username:"",mobile:"",email:"",project_name:""},Pager:"",addDlg:!1,addForm:{username:"",mobile:"",email:"",project_id:"",project_name:"",password:"",weChat_name:""},editDlg:!1,editForm:{username:"",mobile:"",email:"",project_id:"",project_name:"",password:"",weChat_name:""},showResetPassword:!1,addProDlg:!1,addProForm:{project_id:"",users:""},rulesUser:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"}]},readonlyInput:!0,usersExclude:[]}},computed:{...(0,g.rn)(["pro","interfaces"]),...(0,g.Se)(["interfaces1","interfaces2"])},methods:{cancelReadOnly(){this.readonlyInput=!1},async getAllUser(e,l){const a=this.QueryCondition.username.trim(),t=this.QueryCondition.mobile.trim(),o=this.QueryCondition.email.trim(),s=this.QueryCondition.project_name.trim();let r=[];a&&r.push(`&username=${encodeURIComponent(a)}`),t&&r.push(`&mobile=${encodeURIComponent(t)}`),o&&r.push(`&email=${encodeURIComponent(o)}`),s&&r.push(`&project_name=${encodeURIComponent(s)}`);let d="/users/user/";e&&l||e?d+=`?page=${e}&size=${l}${r.join("")}`:l&&(d+=`?size=${l}${r.join("")}`);const i=await this.$api.getAlluser(d,this.pro.id);200===i.status&&(this.UserLsit=i.data.result,this.Pager=i.data)},async getExcludeUser(){const e=await this.$api.getExcludeUser(this.pro.id);if(200===e.status){const l=e.data;this.usersExclude=l.map((e=>({id:e.id,username:e.username}))),console.log("打印：",this.usersExclude)}},async clickExcludeUser(){const e={...this.addProForm},l=await this.$api.addExcludeUser(e);200===l.status&&(this.$message({type:"success",message:"用户添加成功",duration:1e3}),this.addProDlg=!1,this.getAllUser(1,this.Pager.size))},resetForm(){this.QueryCondition.username="",this.QueryCondition.mobile="",this.QueryCondition.email="",this.QueryCondition.project_name="",console.log(this.interfaces)},submitForm(){this.getAllUser(1,this.Pager.size)},clickAdd(){this.addDlg=!0,this.addForm={username:"",mobile:"",email:"",password:"",project_id:this.pro.id,project_name:this.pro.name,weChat_name:""}},clickAddPro(){this.addProDlg=!0,this.addProForm={project_id:this.pro.id,project_name:this.pro.name,users:[]},this.getExcludeUser()},clearValidation(){this.addDlg=!1,this.editDlg=!1,this.addProDlg=!1,this.showResetPassword=!1,this.$refs.UserRef.clearValidate()},AddInter(){this.$refs.UserRef.validate((async e=>{if(!e)return;const l={...this.addForm},a=await this.$api.createUser(l);201===a.status&&(this.$message({type:"success",message:"用户添加成功",duration:1e3}),this.addForm={username:"",mobile:"",email:"",password:"",project_id:"",project_name:"",weChat_name:""},this.addDlg=!1,this.showResetPassword=!1,this.getAllUser(1,this.Pager.size))}))},UpdateInter(){this.$refs.UserRef.validate((async e=>{if(!e)return;const l=this.editForm;console.log(l);const a=await this.$api.updateUser(l.id,l);200===a.status&&(this.$message({type:"success",message:"用户修改成功",duration:1e3}),this.addForm={username:"",mobile:"",email:"",password:"",project_id:"",project_name:"",weChat_name:""},this.editDlg=!1,this.showResetPassword=!1,this.getAllUser(1,this.Pager.size))}))},resetPassword(){this.showResetPassword=!this.showResetPassword,!1===this.showResetPassword&&(this.editForm.password="")},clickEdit(e){this.editDlg=!0,this.editForm={...e},this.editForm.project_id=this.pro.id,this.editForm.project_name=this.pro.name},delUser(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const l=await this.$api.deleteUser(e);204===l.status&&(this.$message({type:"success",message:"删除成功!"}),this.getAllUser(1,this.Pager.size))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},currentPages(e){this.getAllUser(e,this.Pager.size),this.Pager.page=e,console.log(e)},sizes(e){this.getAllUser(1,e)}},created(){this.getAllUser(1,10)}},f=a(40089);const _=(0,f.Z)(w,[["render",h],["__scopeId","data-v-5b95afe2"]]);var b=_}}]);
//# sourceMappingURL=422.3907d3b1.js.map