"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[374],{93541:function(e,l,t){t.d(l,{Z:function(){return d}});t(70560);var a=t(73396),s=t(87139);function u(e,l,t,u,o,i){const n=(0,a.up)("el-input"),d=(0,a.up)("el-col"),r=(0,a.up)("el-option"),p=(0,a.up)("el-select"),m=(0,a.up)("el-button"),c=(0,a.up)("el-row"),w=(0,a.up)("el-upload"),g=(0,a.up)("el-tag"),f=(0,a.up)("el-table-column"),h=(0,a.up)("el-table"),y=(0,a.up)("el-card");return(0,a.wg)(),(0,a.j4)(c,{gutter:40},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:15},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.params,((e,l)=>((0,a.wg)(),(0,a.j4)(c,{key:l,gutter:5,style:{"margin-top":"5px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(d,{span:5},{default:(0,a.w5)((()=>[(0,a.Wm)(n,{size:"mini",modelValue:e[0],"onUpdate:modelValue":l=>e[0]=l,placeholder:"参数名",clearable:""},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),(0,a.Wm)(d,{span:4},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{onChange:e=>i.seleType(e,l),modelValue:o.paramsType[l],"onUpdate:modelValue":e=>o.paramsType[l]=e,placeholder:"参数类型",size:"mini",style:{width:"100%"}},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{label:"Text",value:"text"}),(0,a.Wm)(r,{label:"File",value:"file"})])),_:2},1032,["onChange","modelValue","onUpdate:modelValue"])])),_:2},1024),(0,a.Wm)(d,{span:11},{default:(0,a.w5)((()=>["text"==o.paramsType[l]?((0,a.wg)(),(0,a.j4)(n,{key:0,modelValue:e[1],"onUpdate:modelValue":l=>e[1]=l,placeholder:"参数值",size:"mini",clearable:""},null,8,["modelValue","onUpdate:modelValue"])):((0,a.wg)(),(0,a.j4)(p,{key:1,onChange:e=>i.seleFile(e,l),modelValue:e[1][0],"onUpdate:modelValue":l=>e[1][0]=l,size:"mini",placeholder:"选择已有文件",style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.files,(e=>((0,a.wg)(),(0,a.j4)(r,{label:e.info[0],value:e.info[0]},null,8,["label","value"])))),256))])),_:2},1032,["onChange","modelValue","onUpdate:modelValue"]))])),_:2},1024),(0,a.Wm)(d,{span:4},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{icon:"el-icon-delete",onClick:e=>o.params.splice(l,1),size:"mini",type:"danger",plain:""},null,8,["onClick"])])),_:2},1024)])),_:2},1024)))),128)),(0,a.Wm)(m,{style:{"margin-top":"10px"},icon:"el-icon-plus",onClick:l[0]||(l[0]=e=>o.params.push(["",""])),size:"mini",type:"success",plain:""})])),_:1}),(0,a.Wm)(d,{span:9},{default:(0,a.w5)((()=>[(0,a.Wm)(y,null,{default:(0,a.w5)((()=>[(0,a.Wm)(w,{class:"upload-demo",action:e.$api.uploadApi.url,headers:i.updateHead,"show-file-list":!1,"on-success":i.uploadSuccess,"on-error":i.uploadError,name:"file"},{default:(0,a.w5)((()=>[(0,a.Wm)(m,{type:"success",plain:"",size:"mini"},{default:(0,a.w5)((()=>[(0,a.Uk)("上传文件")])),_:1})])),_:1},8,["action","headers","on-success","on-error"]),(0,a.Wm)(h,{data:o.files,style:{width:"100%"},size:"mini",height:"200px","empty-text":"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(f,{label:"已有文件"},{default:(0,a.w5)((e=>[(0,a.Wm)(g,{type:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.row.info[0]),1)])),_:2},1024)])),_:1}),(0,a.Wm)(f,{label:"文件类型"},{default:(0,a.w5)((e=>[(0,a.Wm)(g,{type:"info"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.row.info[2]),1)])),_:2},1024)])),_:1}),(0,a.Wm)(f,{label:"操作"},{default:(0,a.w5)((e=>[(0,a.Wm)(m,{onClick:l=>i.deleteFile(e),type:"danger",size:"small",icon:"el-icon-delete",plain:""},null,8,["onClick"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1})}var o={data(){return{params:[],files:[],paramsType:[]}},props:{modelValue:{type:Array,default:[["",""]]}},computed:{updateHead(){return{Authorization:"Bearer "+window.sessionStorage.getItem("token")}}},emits:["update:modelValue"],methods:{seleType(e,l){this.params[l][1]="file"===e?["","",""]:""},seleFile(e,l){const t=this.files.find((l=>l.info[0]===e));this.params[l][1]=[...t.info],console.log(this.params)},uploadSuccess(e){this.$message({type:"success",message:"文件上传成功!",duration:2e3}),this.getAllfile()},uploadError(e){this.$message({type:"error",message:JSON.parse(e.message)[0],duration:2e3})},async getAllfile(){const e=await this.$api.getFiles();200===e.status&&(this.files=e.data)},async deleteFile(e){console.log(e);const l=await this.$api.deleteFile(e.row.id);204===l.status&&(this.$message({type:"success",message:"删除成功！",duration:2e3}),this.files.splice(e.$index,1))},getParamsType(){this.paramsType=[],this.params.forEach((e=>{"string"===typeof e[1]?this.paramsType.push("text"):this.paramsType.push("file")}))}},created(){this.modelValue.length>0?this.params=this.modelValue:this.params=[["",""]],this.getAllfile(),this.getParamsType()},watch:{"params.length":function(e){this.getParamsType()},params:{deep:!0,handler:function(e){this.$emit("update:modelValue",e)}},modelValue:{deep:!0,handler:function(e){this.params=e}}}},i=t(40089);const n=(0,i.Z)(o,[["render",u]]);var d=n},81578:function(e,l,t){t.d(l,{Z:function(){return C}});var a=t(73396),s=t(49242),u=t(87139);const o={key:0},i={key:0},n={key:1},d={key:0,class:"tab-box-sli"},r={style:{color:"#747474"}},p={key:0},m=(0,a._)("b",null,"General",-1),c=(0,a._)("b",null,"Request Headers",-1),w=(0,a._)("b",null,"Request Payload",-1),g={class:"tab-box-sli"},f={key:4,style:{color:"#d60000"}},h={key:0,style:{color:"#00AA7F"}},y={key:1,style:{color:"#d18d17"}},_={key:2,style:{color:"#ff0000"}},b={key:0,style:{color:"#00AA7F"}},k={key:1,style:{color:"#ff5500"}},W={key:0,style:{"margin-top":"10px",width:"100%","text-align":"center"}},V={class:"dialog-footer"};function z(e,l,t,z,v,D){const U=(0,a.up)("Editor"),x=(0,a.up)("el-tab-pane"),F=(0,a.up)("el-tag"),C=(0,a.up)("el-scrollbar"),j=(0,a.up)("el-collapse-item"),q=(0,a.up)("el-collapse"),T=(0,a.up)("el-tabs"),R=(0,a.up)("el-button"),A=(0,a.up)("el-option"),B=(0,a.up)("el-select"),$=(0,a.up)("el-form-item"),H=(0,a.up)("el-input"),E=(0,a.up)("el-form"),N=(0,a.up)("el-dialog");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(T,{"model-value":"rb",style:{"min-height":"300px"},type:"border-card",value:"rb",size:"mini"},{default:(0,a.w5)((()=>["api"==t.result.type?((0,a.wg)(),(0,a.j4)(x,{key:0,label:"响应体",name:"rb"},{default:(0,a.w5)((()=>[t.result.response_header?((0,a.wg)(),(0,a.iD)("div",o,[-1!=t.result.response_header["Content-Type"].search("application/json")?((0,a.wg)(),(0,a.iD)("div",i,[(0,a.Wm)(U,{readOnly:!0,modelValue:t.result.response_body,"onUpdate:modelValue":l[0]||(l[0]=e=>t.result.response_body=e),lang:"json",theme:"chrome"},null,8,["modelValue"])])):((0,a.wg)(),(0,a.iD)("div",n,[(0,a.Wm)(U,{readOnly:!0,modelValue:t.result.response_body,"onUpdate:modelValue":l[1]||(l[1]=e=>t.result.response_body=e),lang:"html",theme:"chrome",height:"500px"},null,8,["modelValue"])]))])):(0,a.kq)("",!0)])),_:1})):(0,a.kq)("",!0),"api"==t.result.type?((0,a.wg)(),(0,a.j4)(x,{key:1,label:"响应头",name:"rh"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{height:"400px",onWheel:l[2]||(l[2]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[t.result.response_header?((0,a.wg)(),(0,a.iD)("div",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.result.response_header,((e,l)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a.Wm)(F,{style:{"margin-top":"3px"},type:"info"},{default:(0,a.w5)((()=>[(0,a._)("b",r,(0,u.zw)(l+" : "),1),(0,a._)("span",null,(0,u.zw)(e),1)])),_:2},1024)])))),256))])):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0),"api"==t.result.type?((0,a.wg)(),(0,a.j4)(x,{key:2,label:"请求信息",name:"rq"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{height:"400px",onWheel:l[4]||(l[4]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[t.result.requests_body?((0,a.wg)(),(0,a.iD)("div",p,[(0,a.Wm)(q,{modelValue:v.activeNames,"onUpdate:modelValue":l[3]||(l[3]=e=>v.activeNames=e),class:"tab-box-sli"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{name:"1"},{title:(0,a.w5)((()=>[m])),default:(0,a.w5)((()=>[(0,a._)("div",null,"Request Method : "+(0,u.zw)(t.result.method),1),(0,a._)("div",null,"Request URL : "+(0,u.zw)(t.result.url),1)])),_:1}),(0,a.Wm)(j,{name:"2"},{title:(0,a.w5)((()=>[c])),default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.result.requests_header,((e,l)=>((0,a.wg)(),(0,a.iD)("div",null,[(0,a._)("span",null,(0,u.zw)(l+" : "+e)+" :",1)])))),256))])),_:1}),(0,a.Wm)(j,{name:"3"},{title:(0,a.w5)((()=>[w])),default:(0,a.w5)((()=>[(0,a._)("span",null,(0,u.zw)(t.result.requests_body),1)])),_:1})])),_:1},8,["modelValue"])])):(0,a.kq)("",!0)])),_:1})])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(x,{label:"日志"},{default:(0,a.w5)((()=>[(0,a.Wm)(C,{height:"400px",onWheel:l[5]||(l[5]=(0,s.iM)((()=>{}),["stop"]))},{default:(0,a.w5)((()=>[(0,a._)("div",g,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.result.log_data,((e,l)=>((0,a.wg)(),(0,a.iD)("div",null,["DEBUG"===e[0]?((0,a.wg)(),(0,a.j4)(F,{key:0,style:{"margin-top":"3px"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e[1]),1)])),_:2},1024)):"WARNING"===e[0]?((0,a.wg)(),(0,a.j4)(F,{key:1,style:{"margin-top":"3px"},type:"warning"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e[1]),1)])),_:2},1024)):"ERROR"===e[0]?((0,a.wg)(),(0,a.j4)(F,{key:2,style:{"margin-top":"3px"},type:"danger"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e[1]),1)])),_:2},1024)):"INFO"===e[0]?((0,a.wg)(),(0,a.j4)(F,{key:3,style:{"margin-top":"3px"},type:"success"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)(e[1]),1)])),_:2},1024)):"EXCEPT"===e[0]?((0,a.wg)(),(0,a.iD)("pre",f,(0,u.zw)(e[1]),1)):(0,a.kq)("",!0)])))),256))])])),_:1})])),_:1}),(0,a.Wm)(x,{disabled:""},{label:(0,a.w5)((()=>["成功"===t.result.state?((0,a.wg)(),(0,a.iD)("span",h,(0,u.zw)("Assert : "+t.result.state),1)):"失败"===t.result.state?((0,a.wg)(),(0,a.iD)("span",y,(0,u.zw)("Assert : "+t.result.state),1)):((0,a.wg)(),(0,a.iD)("span",_,(0,u.zw)(t.result.state),1))])),_:1}),"api"==t.result.type?((0,a.wg)(),(0,a.j4)(x,{key:3,disabled:""},{label:(0,a.w5)((()=>[t.result.status_cede<=300?((0,a.wg)(),(0,a.iD)("span",b,(0,u.zw)("Status : "+t.result.status_cede),1)):((0,a.wg)(),(0,a.iD)("span",k,(0,u.zw)("Status : "+t.result.status_cede),1))])),_:1})):(0,a.kq)("",!0),(0,a.Wm)(x,{disabled:""},{label:(0,a.w5)((()=>[(0,a.Uk)((0,u.zw)("Time : "+t.result.run_time),1)])),_:1})])),_:1}),"失败"===t.result.state&&t.showbtn?((0,a.wg)(),(0,a.iD)("div",W,[(0,a.Wm)(R,{onClick:D.getInterfaces,type:"success",plain:"",size:"mini"},{default:(0,a.w5)((()=>[(0,a.Uk)("提交bug")])),_:1},8,["onClick"])])):(0,a.kq)("",!0),(0,a.Wm)(N,{title:"提交bug",modelValue:v.addBugDlg,"onUpdate:modelValue":l[8]||(l[8]=e=>v.addBugDlg=e),width:"40%","before-close":D.closeDialogResult},{footer:(0,a.w5)((()=>[(0,a._)("div",V,[(0,a.Wm)(R,{onClick:D.closeDialogResult},{default:(0,a.w5)((()=>[(0,a.Uk)("取 消")])),_:1},8,["onClick"]),(0,a.Wm)(R,{type:"success",onClick:D.saveBug},{default:(0,a.w5)((()=>[(0,a.Uk)("确 定")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(E,{model:v.bugForm},{default:(0,a.w5)((()=>[(0,a.Wm)($,{label:"所属接口"},{default:(0,a.w5)((()=>[(0,a.Wm)(B,{size:"small",modelValue:v.bugForm.interface,"onUpdate:modelValue":l[6]||(l[6]=e=>v.bugForm.interface=e),placeholder:"bug对应的接口",style:{width:"100%"}},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(v.interfaces,(e=>((0,a.wg)(),(0,a.j4)(A,{label:e.name+" "+e.url,value:e.id,key:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)($,{label:"bug描述"},{default:(0,a.w5)((()=>[(0,a.Wm)(H,{autosize:{minRows:3,maxRows:4},modelValue:v.bugForm.desc,"onUpdate:modelValue":l[7]||(l[7]=e=>v.bugForm.desc=e),type:"textarea",autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model"])])),_:1},8,["modelValue","before-close"])],64)}var v=t(62669),D=t(20065),U={props:{result:{default:{}},showbtn:{default:!0}},computed:{...(0,D.rn)(["pro"])},components:{Editor:v.Z},data(){return{activeNames:["1","2","3"],addBugDlg:!1,bugForm:{interface:null,desc:"",info:"",status:"待处理"},interfaces:[]}},methods:{async saveBug(){this.bugForm.project=this.pro.id,this.bugForm.info=this.result;const e=await this.$api.createBugs(this.bugForm);201===e.status&&(this.$message({type:"success",message:"bug提交成功",duration:1e3}),this.addBugDlg=!1,this.bugForm={interface:null,desc:"",info:"",status:"待处理"})},closeDialogResult(){this.addBugDlg=!1,this.bugForm={interface:null,desc:"",info:"",status:"待处理"}},async getInterfaces(){const e=await this.$api.getnewInterfaces();200===e.status&&(this.interfaces=e.data,this.addBugDlg=!0)}}},x=t(40089);const F=(0,x.Z)(U,[["render",z]]);var C=F}}]);
//# sourceMappingURL=374.5497f76a.js.map