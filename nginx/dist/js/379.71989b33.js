"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[379],{74024:function(e,a,t){t.d(a,{Z:function(){return A}});var l=t(73396),s=t(87139),o=t(49242);const n=e=>((0,l.dD)("data-v-71c3b3f0"),e=e(),(0,l.Cn)(),e),d={style:{margin:"10px"}},i=n((()=>(0,l._)("b",null,"Api信息",-1))),r={key:0},c=n((()=>(0,l._)("b",null,"请求信息",-1))),u={key:0},m={key:1},p={key:2},f={class:"code_mod"},h={class:"code_mod"},_={class:"code_mod"},g={class:"code_mod"},w={class:"code_mod"},y={class:"code_mod"},k={class:"code_mod"},b={class:"code_mod"},W={class:"code_mod"},C={class:"code_mod"},T={class:"code_mod"},V={class:"code_mod"},v={class:"code_mod"},I={class:"code_mod"},D={key:0},U=n((()=>(0,l._)("b",null,"执行结果",-1)));function x(e,a,t,n,x,E){const j=(0,l.up)("el-divider"),q=(0,l.up)("el-option"),z=(0,l.up)("el-select"),$=(0,l.up)("el-input"),S=(0,l.up)("el-form-item"),F=(0,l.up)("el-col"),N=(0,l.up)("el-button"),A=(0,l.up)("el-row"),R=(0,l.up)("el-cascader"),M=(0,l.up)("el-tag"),P=(0,l.up)("el-scrollbar"),O=(0,l.up)("el-form"),H=(0,l.up)("Editor"),J=(0,l.up)("el-tab-pane"),B=(0,l.up)("el-radio"),Z=(0,l.up)("el-radio-group"),L=(0,l.up)("FromData"),Y=(0,l.up)("el-tabs"),G=(0,l.up)("caseResult");return(0,l.wg)(),(0,l.j4)(P,{height:"calc(100vh);padding-right:10px;"},{default:(0,l.w5)((()=>[(0,l._)("div",d,[(0,l.Wm)(j,{"content-position":"left",style:{"margin-bottom":"30px"}},{default:(0,l.w5)((()=>[i])),_:1}),(0,l.Wm)(O,{rules:x.rulesinterface,ref:"interfaceRef",model:x.caseInfo},{default:(0,l.w5)((()=>[!0===t.copyDlg?((0,l.wg)(),(0,l.j4)(A,{key:0,gutter:10,style:{"margin-bottom":"20px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{span:15},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{prop:"url"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{modelValue:x.caseInfo.url,"onUpdate:modelValue":a[1]||(a[1]=e=>x.caseInfo.url=e),placeholder:"请输入接口地址"},{prepend:(0,l.w5)((()=>[(0,l.Wm)(z,{modelValue:x.caseInfo.method,"onUpdate:modelValue":a[0]||(a[0]=e=>x.caseInfo.method=e),placeholder:"请求类型",size:"small",style:{width:"96px",color:"black"}},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"GET",value:"GET",style:{color:"rgba(204,73,145,0.87)"}}),(0,l.Wm)(q,{label:"POST",value:"POST",style:{color:"#61affe"}}),(0,l.Wm)(q,{label:"PUT",value:"PUT",style:{color:"#fca130"}}),(0,l.Wm)(q,{label:"PATCH",value:"PATCH",style:{color:"#50e3c2"}}),(0,l.Wm)(q,{label:"DELETE",value:"DELETE",style:{color:"#f93e3e"}}),(0,l.Wm)(q,{label:"HEAD",value:"HEAD",style:{color:"rgb(201, 233, 104)"}})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:9,style:{"text-align":"right"}},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{onClick:E.runCase,type:"success",icon:"el-icon-s-promotion"},{default:(0,l.w5)((()=>[(0,l.Uk)("调试")])),_:1},8,["onClick"]),(0,l.Wm)(N,{onClick:E.editClick,type:"primary",icon:"el-icon-edit-outline"},{default:(0,l.w5)((()=>[(0,l.Uk)("保存")])),_:1},8,["onClick"]),(0,l.Wm)(N,{onClick:E.copyCases,type:"primary",icon:"el-icon-copy-document"},{default:(0,l.w5)((()=>[(0,l.Uk)("复制")])),_:1},8,["onClick"])])),_:1})])),_:1})):((0,l.wg)(),(0,l.j4)(A,{key:1,gutter:10,style:{"margin-bottom":"20px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{prop:"url"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{modelValue:x.caseInfo.url,"onUpdate:modelValue":a[3]||(a[3]=e=>x.caseInfo.url=e),placeholder:"请输入接口地址"},{prepend:(0,l.w5)((()=>[(0,l.Wm)(z,{modelValue:x.caseInfo.method,"onUpdate:modelValue":a[2]||(a[2]=e=>x.caseInfo.method=e),placeholder:"请求类型",size:"small",style:{width:"96px",color:"black"}},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"GET",value:"GET",style:{color:"rgba(204,73,145,0.87)"}}),(0,l.Wm)(q,{label:"POST",value:"POST",style:{color:"#61affe"}}),(0,l.Wm)(q,{label:"PUT",value:"PUT",style:{color:"#fca130"}}),(0,l.Wm)(q,{label:"PATCH",value:"PATCH",style:{color:"#50e3c2"}}),(0,l.Wm)(q,{label:"DELETE",value:"DELETE",style:{color:"#f93e3e"}}),(0,l.Wm)(q,{label:"HEAD",value:"HEAD",style:{color:"rgb(201, 233, 104)"}})])),_:1},8,["modelValue"])])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:6,style:{"text-align":"right"}},{default:(0,l.w5)((()=>[(0,l.Wm)(N,{onClick:E.runCase,type:"success",icon:"el-icon-s-promotion"},{default:(0,l.w5)((()=>[(0,l.Uk)("调试")])),_:1},8,["onClick"]),(0,l.Wm)(N,{onClick:E.editClick,type:"primary",icon:"el-icon-edit-outline"},{default:(0,l.w5)((()=>[(0,l.Uk)("保存")])),_:1},8,["onClick"])])),_:1})])),_:1})),(0,l.Wm)(A,{gutter:24,style:{"margin-bottom":"20px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{span:7},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"节点/模块"},{default:(0,l.w5)((()=>[(0,l.Wm)(R,{modelValue:x.caseInfo.treenode,"onUpdate:modelValue":a[4]||(a[4]=e=>x.caseInfo.treenode=e),options:x.options,props:{label:"name",value:"id",checkStrictly:!0},onChange:E.removeCascaderAriaOwns,onVisibleChange:E.removeCascaderAriaOwns,onExpandChange:E.removeCascaderAriaOwns,clearable:"","change-on-select":"",filterable:""},null,8,["modelValue","options","onChange","onVisibleChange","onExpandChange"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:9},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"接口名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{modelValue:x.caseInfo.name,"onUpdate:modelValue":a[5]||(a[5]=e=>x.caseInfo.name=e),placeholder:"请输入接口名称",clearable:"",style:{width:"200px"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:8},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"导入数据是否锁定"},{default:(0,l.w5)((()=>[(0,l.Wm)(z,{modelValue:E.selectedStatus,"onUpdate:modelValue":a[6]||(a[6]=e=>E.selectedStatus=e),placeholder:"请选择"},{default:(0,l.w5)((()=>[(0,l.Wm)(q,{label:"已锁定",value:"1"}),(0,l.Wm)(q,{label:"无需锁定",value:"0"})])),_:1},8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"描述"},{default:(0,l.w5)((()=>[(0,l.Wm)($,{modelValue:x.caseInfo.desc,"onUpdate:modelValue":a[7]||(a[7]=e=>x.caseInfo.desc=e),type:"textarea",clearable:"",style:{width:"350px"}},null,8,["modelValue"])])),_:1})])),_:1}),(0,l.Wm)(F,{span:12},{default:(0,l.w5)((()=>[(0,l.Wm)(P,{height:"60px"},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"接口标签"},{default:(0,l.w5)((()=>[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(x.caseInfo.interface_tag,(e=>((0,l.wg)(),(0,l.j4)(M,{key:e,size:"small",type:E.getRandomType(),closable:"","disable-transitions":!1,style:{"margin-right":"5px"},onClose:a=>E.removeTag(e),effect:"light"},{default:(0,l.w5)((()=>[(0,l.Uk)((0,s.zw)(e),1)])),_:2},1032,["type","onClose"])))),128)),x.state.editTag?((0,l.wg)(),(0,l.j4)($,{key:0,ref:"caseTagInputRef",modelValue:x.state.tagValue,"onUpdate:modelValue":a[8]||(a[8]=e=>x.state.tagValue=e),size:"small",onKeyup:(0,o.D2)(E.addTag,["enter"]),onBlur:E.addTag,style:{width:"100px"},maxlength:"30"},null,8,["modelValue","onKeyup","onBlur"])):((0,l.wg)(),(0,l.j4)(N,{key:1,size:"small",onClick:E.showEditTag},{default:(0,l.w5)((()=>[(0,l.Uk)("+ New Tag")])),_:1},8,["onClick"]))])),_:1})])),_:1})])),_:1}),(0,l.Wm)(F,{span:5},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"创建用户：",style:{"margin-top":"10px"}},{default:(0,l.w5)((()=>[(0,l._)("a",null,(0,s.zw)(this.caseInfo.creator),1)])),_:1})])),_:1}),(0,l.Wm)(F,{span:7},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"创建时间：",style:{"margin-top":"10px"}},{default:(0,l.w5)((a=>[(0,l._)("a",null,(0,s.zw)(e.$tools.rTime(this.caseInfo.create_time)),1)])),_:1})])),_:1}),(0,l.Wm)(F,{span:5},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"修改用户：",style:{"margin-top":"10px"}},{default:(0,l.w5)((()=>[(0,l._)("a",null,(0,s.zw)(this.caseInfo.modifier),1)])),_:1})])),_:1}),(0,l.Wm)(F,{span:7},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{label:"修改时间：",style:{"margin-top":"10px"}},{default:(0,l.w5)((a=>[this.caseInfo.update_time?((0,l.wg)(),(0,l.iD)("a",r,(0,s.zw)(e.$tools.rTime(this.caseInfo.update_time)),1)):(0,l.kq)("",!0)])),_:1})])),_:1})])),_:1})])),_:1},8,["rules","model"]),(0,l.Wm)(j,{"content-position":"left",style:{"margin-top":"0px"}},{default:(0,l.w5)((()=>[c])),_:1}),(0,l.Wm)(Y,{type:"border-card",style:{"min-height":"370px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(J,{label:"请求头(headers)"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{modelValue:x.headers,"onUpdate:modelValue":a[9]||(a[9]=e=>x.headers=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(J,{label:"查询参数(Params)"},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{modelValue:x.params,"onUpdate:modelValue":a[10]||(a[10]=e=>x.params=e)},null,8,["modelValue"])])),_:1}),(0,l.Wm)(J,{label:"请求体(Body)"},{default:(0,l.w5)((()=>[(0,l.Wm)(Z,{modelValue:x.paramType,"onUpdate:modelValue":a[11]||(a[11]=e=>x.paramType=e),style:{"margin-bottom":"5px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(B,{label:"json"},{default:(0,l.w5)((()=>[(0,l.Uk)("application/json")])),_:1}),(0,l.Wm)(B,{label:"data"},{default:(0,l.w5)((()=>[(0,l.Uk)("x-www-form-urlencoded")])),_:1}),(0,l.Wm)(B,{label:"formData"},{default:(0,l.w5)((()=>[(0,l.Uk)("form-data")])),_:1})])),_:1},8,["modelValue"]),"json"===x.paramType?((0,l.wg)(),(0,l.iD)("div",u,[(0,l.Wm)(H,{modelValue:x.json,"onUpdate:modelValue":a[12]||(a[12]=e=>x.json=e)},null,8,["modelValue"])])):"data"===x.paramType?((0,l.wg)(),(0,l.iD)("div",m,[(0,l.Wm)(H,{modelValue:x.data,"onUpdate:modelValue":a[13]||(a[13]=e=>x.data=e)},null,8,["modelValue"])])):"formData"===x.paramType?((0,l.wg)(),(0,l.iD)("div",p,[(0,l.Wm)(L,{modelValue:x.file,"onUpdate:modelValue":a[14]||(a[14]=e=>x.file=e)},null,8,["modelValue"])])):(0,l.kq)("",!0)])),_:1}),(0,l.Wm)(J,{label:"前置脚本"},{default:(0,l.w5)((()=>[(0,l.Wm)(A,{gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{modelValue:x.caseInfo.setup_script,"onUpdate:modelValue":a[15]||(a[15]=e=>x.caseInfo.setup_script=e),lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(F,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{style:{width:"195px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("脚本模板")])),_:1}),(0,l._)("div",f,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[16]||(a[16]=e=>E.addSetUptCodeMod("ENV"))},{default:(0,l.w5)((()=>[(0,l.Uk)("预设全局变量")])),_:1})]),(0,l._)("div",h,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[17]||(a[17]=e=>E.addSetUptCodeMod("env"))},{default:(0,l.w5)((()=>[(0,l.Uk)("预设局部变量")])),_:1})]),(0,l._)("div",_,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[18]||(a[18]=e=>E.addSetUptCodeMod("func"))},{default:(0,l.w5)((()=>[(0,l.Uk)("调用全局函数")])),_:1})]),(0,l._)("div",g,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[19]||(a[19]=e=>E.addSetUptCodeMod("sql"))},{default:(0,l.w5)((()=>[(0,l.Uk)("执行sql查询")])),_:1})])])),_:1})])),_:1})])),_:1}),(0,l.Wm)(J,{label:"后置脚本"},{default:(0,l.w5)((()=>[(0,l.Wm)(A,{gutter:10},{default:(0,l.w5)((()=>[(0,l.Wm)(F,{span:18},{default:(0,l.w5)((()=>[(0,l.Wm)(H,{modelValue:x.caseInfo.teardown_script,"onUpdate:modelValue":a[20]||(a[20]=e=>x.caseInfo.teardown_script=e),lang:"python",theme:"monokai"},null,8,["modelValue"])])),_:1}),(0,l.Wm)(F,{span:6},{default:(0,l.w5)((()=>[(0,l.Wm)(j,{style:{width:"195px"}},{default:(0,l.w5)((()=>[(0,l.Uk)("脚本模板")])),_:1}),(0,l.Wm)(P,{height:"250px"},{default:(0,l.w5)((()=>[(0,l._)("div",w,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[21]||(a[21]=e=>E.addTearDownCodeMod("getBody"))},{default:(0,l.w5)((()=>[(0,l.Uk)("获取响应体")])),_:1})]),(0,l._)("div",y,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[22]||(a[22]=e=>E.addTearDownCodeMod("JSextract"))},{default:(0,l.w5)((()=>[(0,l.Uk)("jsonpath提取数据")])),_:1})]),(0,l._)("div",k,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[23]||(a[23]=e=>E.addTearDownCodeMod("REextract"))},{default:(0,l.w5)((()=>[(0,l.Uk)("正则提取数据")])),_:1})]),(0,l._)("div",b,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[24]||(a[24]=e=>E.addTearDownCodeMod("ENV"))},{default:(0,l.w5)((()=>[(0,l.Uk)("设置全局变量")])),_:1})]),(0,l._)("div",W,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[25]||(a[25]=e=>E.addTearDownCodeMod("env"))},{default:(0,l.w5)((()=>[(0,l.Uk)("设置局部变量")])),_:1})]),(0,l._)("div",C,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[26]||(a[26]=e=>E.addTearDownCodeMod("func"))},{default:(0,l.w5)((()=>[(0,l.Uk)("调用全局函数")])),_:1})]),(0,l._)("div",T,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[27]||(a[27]=e=>E.addTearDownCodeMod("sql"))},{default:(0,l.w5)((()=>[(0,l.Uk)("执行sql查询")])),_:1})]),(0,l._)("div",V,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[28]||(a[28]=e=>E.addTearDownCodeMod("http"))},{default:(0,l.w5)((()=>[(0,l.Uk)("断言HTTP状态码")])),_:1})]),(0,l._)("div",v,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[29]||(a[29]=e=>E.addTearDownCodeMod("eq"))},{default:(0,l.w5)((()=>[(0,l.Uk)("断言相对")])),_:1})]),(0,l._)("div",I,[(0,l.Wm)(N,{type:"success",size:"mini",plain:"",onClick:a[30]||(a[30]=e=>E.addTearDownCodeMod("contain"))},{default:(0,l.w5)((()=>[(0,l.Uk)("断言包含")])),_:1})])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),x.runResult?((0,l.wg)(),(0,l.iD)("div",D,[(0,l.Wm)(j,{"content-position":"left"},{default:(0,l.w5)((()=>[U])),_:1}),(0,l.Wm)(G,{result:x.runResult},null,8,["result"])])):(0,l.kq)("",!0)])])),_:1})}t(70560);var E=t(81578),j=t(93541),q=t(62669),z=t(20065),$=t(37046),S={props:["Interface_id","copyDlg"],components:{caseResult:E.Z,FromData:j.Z,Editor:q.Z},data(){return{rulesinterface:{name:[{required:!0,message:"请输入接口名称",trigger:"blur"}],url:[{required:!0,message:"请输入接口信息",trigger:"blur"}]},addForm:{},state:{form:{item:[{type:""},{type:"success"},{type:"info"},{type:"danger"},{type:"warning"}]},editTag:!1,tagValue:""},options:[],caseInfo:{method:"POST",interface_tag:[],YApi_status:"",url:"",name:"",treenode:this.treeId,creator:"",modifier:"",desc:"",headers:{},request:{json:{},data:null,params:{}},file:[],setup_script:"# 前置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象",teardown_script:"# 后置脚本(python):\n# global_tools:全局工具函数\n# data:用例数据 \n# response:响应对象response \n# env: 局部环境\n# ENV: 全局环境\n# db: 数据库操作对象"},paramType:"json",json:"{}",data:"{}",params:"{}",headers:"{}",interfaceparams:"{}",file:[],interface_tag:[],runResult:""}},computed:{...(0,z.rn)(["pro","envId"]),username(){return window.sessionStorage.getItem("username")},selectedStatus:{get(){return 1==this.caseInfo.YApi_status?"1":"0"},set(e){this.caseInfo.YApi_status=e}}},methods:{focusInput(){this.$nextTick((()=>{this.$refs.caseTagInputRef.focus()}))},addTag(){this.state.editTag&&this.state.tagValue&&(this.caseInfo.interface_tag||(this.caseInfo.interface_tag=[]),this.caseInfo.interface_tag.push(this.state.tagValue),this.focusInput()),this.state.editTag=!1,this.state.tagValue=""},removeTag(e){this.caseInfo.interface_tag.splice(this.caseInfo.interface_tag.indexOf(e),1)},showEditTag(){this.state.editTag=!0,this.focusInput()},getRandomType(){const e=Math.floor(Math.random()*this.state.form.item.length);return this.state.form.item[e].type},async allTree(){const e=await this.$api.gettreeNode();200===e.status&&(this.options=e.data.result)},removeCascaderAriaOwns(){this.$nextTick((()=>{const e=document.querySelectorAll(".el-cascader-panel .el-cascader-node[aria-owns]");Array.from(e).map((e=>e.removeAttribute("aria-owns")))}))},addSetUptCodeMod(e){switch(e){case"ENV":this.caseInfo.setup_script+='\n# 设置全局变量 \ntest.save_global_variable("变量名","变量值")';break;case"env":this.caseInfo.setup_script+='\n# 设置局部变量  \ntest.save_env_variable("变量名","变量值")';break;case"func":this.caseInfo.setup_script+="\n# 调用全局工具函数random_mobile随机生成一个手机号码  \nmobile = global_func.random_mobile()";break;case"sql":this.caseInfo.setup_script+='\n# ----执行sql语句(需要在环境中配置数据库连接信息)----\n# db.连接名.execute_all(sql语句) \nsql = "SELECT count(*) as count FROM futureloan.member"\nres = db.aliyun.execute_all(sql)';break}},addTearDownCodeMod(e){switch(e){case"getBody":this.caseInfo.teardown_script+="\n# Demo:获取响应体(json)  \nbody = response.json()",this.caseInfo.teardown_script+="\n# Demo2:获取响应体(字符串)  \nbody = response.text";break;case"JSextract":this.caseInfo.teardown_script+='\n# Demo:jsonpath提取response中的msg字段  \nmsg = test.json_extract(response.json(),"$..msg")';break;case"REextract":this.caseInfo.teardown_script+='\n# Demo:正则提取响应体中的数据  \nres = test.re_extract(response.text,"正则表达式",)';break;case"ENV":this.caseInfo.teardown_script+='\n# 设置全局变量 \ntest.save_global_variable("变量名","变量值")';break;case"env":this.caseInfo.teardown_script+='\n# 设置局部变量  \ntest.save_env_variable("变量名","变量值")';break;case"func":this.caseInfo.teardown_script+="\n# 调用全局工具函数random_mobile随机生成一个手机号码  \nmobile = global_func.random_mobile()";break;case"sql":this.caseInfo.teardown_script+='\n# ----执行sql语句(需要在环境中配置数据库连接信息)----\n# db.连接名.execute_all(sql语句) \nsql = "SELECT count(*) as count FROM futureloan.member"\nres = db.aliyun.execute_all(sql)';break;case"http":this.caseInfo.teardown_script+='\n# 断言http状态码 \n# Demo:断言http状态码是否为200  \ntest.assertion("相等",200,response.status_code)';break;case"eq":this.caseInfo.teardown_script+='\n# 断言相等 \ntest.assertion("相等","预期结果","实际结果")';break;case"contain":this.caseInfo.teardown_script+='\n# 断言包含:预期结果中的内容在实际结果中是否存在 \ntest.assertion("包含","预期结果","实际结果")';break}},async getInterfaceInfo(e){const a=await this.$api.getnewInterface(e);this.runResult=null,200===a.status&&(this.caseInfo={...a.data},this.json=JSON.stringify(this.caseInfo.request.json||{},null,4),this.data=JSON.stringify(this.caseInfo.request.data||{},null,4),this.params=JSON.stringify(this.caseInfo.request.params||{},null,4),this.headers=JSON.stringify(this.caseInfo.headers||{},null,4),this.caseInfo.interface_tag=Array.from(this.caseInfo.interface_tag.tag),this.file=this.caseInfo.file)},getEditData(){let e={...this.caseInfo};if(delete e.status,e.treenode&&e.treenode.length>0){const a=e.treenode[e.treenode.length-1];console.log(a),e.treenode=a}else console.log("列表为空");e.interface_tag={tag:[...e.interface_tag]},e.modifier=this.username,e.update_time=this.$tools.newTime();try{e.headers=JSON.parse(this.headers)}catch(a){return this.$message({message:"提交的headers数据 json格式错误，请检查！",type:"warning",duration:1e3}),null}if("json"===this.paramType)try{e.request={json:JSON.parse(this.json)},e.request.data=null,e.file=[]}catch(a){return this.$message({message:"提交的application/json数据json格式错误，请检查！",type:"warning",duration:1e3}),null}else if("data"===this.paramType)try{e.request={data:JSON.parse(this.data)},e.request.json=null,e.file=[]}catch(a){return this.$message({message:"提交的x-www-form-urlencoded数据json格式错误，请检查！",type:"warning",duration:1e3}),null}else"formData"===this.paramType&&(e.file=this.file,e.request={});try{return e.request.params=JSON.parse(this.params),e}catch(a){return this.$message({message:"提交的Params数据json格式错误，请检查！",type:"warning",duration:1e3}),null}},async editClick(){this.$refs.interfaceRef.validate((async e=>{if(!e)return;const a=this.getEditData(),t=await this.$api.updatenewInterface(this.Interface_id,a);200===t.status&&(0,$.z8)({type:"success",message:"修改成功",duration:1e3})}))},async runCase(){console.log(this.copyDlg),this.envId?this.$refs.interfaceRef.validate((async e=>{if(!e)return;const a=this.getEditData();a.interface={url:this.caseInfo.url,method:this.caseInfo.method};const t={data:a,env:this.envId},l=await this.$api.runNewCase(t);200===l.status&&(this.runResult=l.data,(0,$.bM)({duration:500,title:"成功",type:"success"}))})):this.$message({type:"warning",message:"当前未选中执行环境!",duration:1e3})},async copyCases(){const e=this.getEditData();e.name=e.name+"_副本",e.creator=this.username,e.modifier="",e.update_time=null;const a=await this.$api.createnewInterface(e);201===a.status&&(0,$.z8)({type:"success",message:"复制成功",duration:1e3})}},created(){this.allTree()}},F=t(40089);const N=(0,F.Z)(S,[["render",x],["__scopeId","data-v-71c3b3f0"]]);var A=N},71955:function(e,a,t){t.d(a,{Z:function(){return w}});var l=t(73396),s=t(87139);const o={class:"tree-component"},n={class:"node-content"},d=["onClick"],i=["onClick"],r=["onClick"],c={class:"dialog-footer"},u={class:"dialog-footer"};function m(e,a,t,m,p,f){const h=(0,l.up)("el-button"),_=(0,l.up)("el-input"),g=(0,l.up)("el-scrollbar"),w=(0,l.up)("CirclePlus"),y=(0,l.up)("el-icon"),k=(0,l.up)("Edit"),b=(0,l.up)("Delete"),W=(0,l.up)("el-tree"),C=(0,l.up)("el-form-item"),T=(0,l.up)("el-form"),V=(0,l.up)("el-dialog");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",o,[(0,l.Wm)(_,{modelValue:p.filterText,"onUpdate:modelValue":a[0]||(a[0]=e=>p.filterText=e),placeholder:"请输入节点名称进行搜索",clearable:""},{append:(0,l.w5)((()=>[(0,l.Wm)(h,{type:"primary",onClick:f.handletreeClick},{default:(0,l.w5)((()=>[(0,l.Uk)("查询")])),_:1},8,["onClick"])])),_:1},8,["modelValue"]),(0,l.Wm)(h,{type:"primary",style:{"margin-bottom":"5px","margin-top":"10px"},onClick:f.clickAdd},{default:(0,l.w5)((()=>[(0,l.Uk)("添加父节点")])),_:1},8,["onClick"]),(0,l.Wm)(g,{height:"calc(100vh - 150px)"},{default:(0,l.w5)((()=>[(0,l.Wm)(W,{class:"filter-tree",data:p.data,props:f.defaultProps,"expand-on-click-node":!1,onNodeClick:f.handleNodeClick,"default-expand-all":!1},{default:(0,l.w5)((({node:e,data:a})=>[(0,l.Wm)(g,null,{default:(0,l.w5)((()=>[(0,l._)("span",{class:(0,s.C_)({"bold-node":null===e.data.parent_id})},(0,s.zw)(e.label),3)])),_:2},1024),(0,l._)("div",n,[(0,l._)("span",null,[(0,l._)("a",{onClick:a=>f.clickAddPart(e.data.id)},[(0,l.Wm)(y,{style:{color:"#0d84ff"}},{default:(0,l.w5)((()=>[(0,l.Wm)(w)])),_:1})],8,d),(0,l._)("a",{onClick:a=>f.clickEdit(e.data)},[(0,l.Wm)(y,{style:{color:"#0d84ff"}},{default:(0,l.w5)((()=>[(0,l.Wm)(k)])),_:1})],8,i),(0,l._)("a",{onClick:a=>f.clickDel(e.data.id)},[(0,l.Wm)(y,{style:{color:"#0d84ff","margin-right":"20px"}},{default:(0,l.w5)((()=>[(0,l.Wm)(b)])),_:1})],8,r)])])])),_:1},8,["data","props","onNodeClick"])])),_:1})]),(0,l.Wm)(V,{modelValue:p.addDlg.Dlg,"onUpdate:modelValue":a[2]||(a[2]=e=>p.addDlg.Dlg=e),title:"0"===p.addDlg.sort?"添加主节点":"添加子节点",width:"20%","before-close":f.clickClear},{footer:(0,l.w5)((()=>[(0,l._)("span",c,[(0,l.Wm)(h,{onClick:f.clickClear},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1},8,["onClick"]),"0"===p.addDlg.sort?((0,l.wg)(),(0,l.j4)(h,{key:0,type:"success",onClick:f.addtree},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["onClick"])):((0,l.wg)(),(0,l.j4)(h,{key:1,type:"success",onClick:f.partaddtree},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["onClick"]))])])),default:(0,l.w5)((()=>[(0,l.Wm)(T,{model:p.addForm,rules:p.rulestree,ref:"treeRef"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{label:"节点名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:p.addForm.name,"onUpdate:modelValue":a[1]||(a[1]=e=>p.addForm.name=e),autocomplete:"off",placeholder:"请输入节点名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","before-close"]),(0,l.Wm)(V,{modelValue:p.editDlg,"onUpdate:modelValue":a[4]||(a[4]=e=>p.editDlg=e),title:"修改节点",width:"20%","before-close":f.clickClear},{footer:(0,l.w5)((()=>[(0,l._)("span",u,[(0,l.Wm)(h,{onClick:f.clickClear},{default:(0,l.w5)((()=>[(0,l.Uk)("取消")])),_:1},8,["onClick"]),(0,l.Wm)(h,{type:"success",onClick:f.updatetree},{default:(0,l.w5)((()=>[(0,l.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,l.w5)((()=>[(0,l.Wm)(T,{model:p.upFrom,rules:p.rulestree,ref:"treeRef"},{default:(0,l.w5)((()=>[(0,l.Wm)(C,{label:"节点名称",prop:"name"},{default:(0,l.w5)((()=>[(0,l.Wm)(_,{modelValue:p.upFrom.name,"onUpdate:modelValue":a[3]||(a[3]=e=>p.upFrom.name=e),autocomplete:"off",placeholder:"请输入节点名称",clearable:""},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"])],64)}var p=t(37046),f=t(20065),h={props:{handleTreeClick:Function},data(){return{filterText:"",data:[],addDlg:{Dlg:!1,sort:""},addForm:{name:"",parent_id:"",project:""},editDlg:!1,upFrom:{name:"",parent_id:"",create_time:"",enable_flag:"",id:"",project:"",type:null},rulestree:{name:[{required:!0,message:"请输入节点名称",trigger:"blur"}]}}},computed:{...(0,f.rn)(["pro"]),defaultProps(){return{children:"children",label:"name"}}},methods:{async allTree(e){if(e){const a=await this.$api.gettreeNode({name:e,project_id:this.pro.id});200===a.status&&(this.data=a.data.result)}else{const e=await this.$api.gettreeNode({project_id:this.pro.id});200===e.status&&(this.data=e.data.result,this.data.length>0&&this.handleTreeClick(this.data[0].id))}},handleNodeClick(e){const a=e.id;this.$emit("treeClick",a)},handleInterfaceClick(){console.log("查询接口")},async addtree(){this.$refs.treeRef.validate((async e=>{if(!e)return;const a=await this.$api.createtreeNode(this.addForm);201===a.status&&((0,p.z8)({type:"success",message:"添加成功",duration:1e3}),this.addDlg.Dlg=!1,this.filterText="",this.addDlg.sort="",this.addForm={name:"",parent_id:null,project:""},this.allTree())}))},async partaddtree(){this.$refs.treeRef.validate((async e=>{if(!e)return;console.log(this.addForm);const a=await this.$api.createtreeNode(this.addForm);201===a.status&&((0,p.z8)({type:"success",message:"添加成功",duration:1e3}),this.addDlg.Dlg=!1,this.addDlg.sort="",this.filterText="",this.addForm={name:"",parent_id:null,project:""},this.allTree())}))},async updatetree(){this.$refs.treeRef.validate((async e=>{if(!e)return;const a=await this.$api.updatetreeNode(this.upFrom.id,this.upFrom);200===a.status&&((0,p.z8)({type:"success",message:"修改成功",duration:1e3}),this.editDlg=!1,this.filterText="",this.upFrom={name:"",parent_id:"",create_time:"",enable_flag:"",id:"",type:null,project:""}),this.allTree()}))},async deltree(e){const a=await this.$api.deltreeNode(e);204===a.status&&((0,p.z8)({type:"success",message:"删除成功",duration:1e3}),this.allTree(),this.filterText="")},handletreeClick(){this.allTree(this.filterText)},clickAdd(){this.addDlg.Dlg=!0,this.addDlg.sort="0",this.addForm={name:"",project:this.pro.id}},clickAddPart(e){this.addDlg.Dlg=!0,this.addDlg.sort="1",console.log(e),this.addForm={name:"",parent_id:e,project:this.pro.id}},clickEdit(e){this.upFrom={...e},this.editDlg=!0,console.log(this.upFrom)},clickClear(){this.editDlg=!1,this.upFrom="",this.addDlg.Dlg=!1,this.addDlg.sort="",this.$refs.treeRef.clearValidate()},clickDel(e){p.T$.confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.deltree(e)})).catch((()=>{(0,p.z8)({type:"info",message:"取消删除",duration:1e3})}))}},created(){this.allTree()}},_=t(40089);const g=(0,_.Z)(h,[["render",m],["__scopeId","data-v-5c7d2880"]]);var w=g}}]);
//# sourceMappingURL=379.71989b33.js.map