"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[805,631],{64616:function(e,l,a){a.r(l),a.d(l,{default:function(){return _}});var t=a(73396),o=a(87139);const s={class:"box"},i={class:"query_model"},r={class:"buttons"},d={class:"dialog-footer"},n={class:"dialog-footer"},m={class:"table_data"},u={key:0},c={class:"pagination-container"};function p(e,l,a,p,h,w){const g=(0,t.up)("el-input"),f=(0,t.up)("el-button"),_=(0,t.up)("el-form-item"),b=(0,t.up)("el-form"),U=(0,t.up)("el-dialog"),V=(0,t.up)("el-table-column"),y=(0,t.up)("el-table"),C=(0,t.up)("el-pagination"),W=(0,t.up)("el-scrollbar");return(0,t.wg)(),(0,t.iD)("div",s,[(0,t.Wm)(W,{height:"calc(100vh - 80px)"},{default:(0,t.w5)((()=>[(0,t._)("div",i,[(0,t._)("span",null,[(0,t.Uk)("用户名 "),(0,t.Wm)(g,{modelValue:h.QueryCondition.username,"onUpdate:modelValue":l[0]||(l[0]=e=>h.QueryCondition.username=e),placeholder:"请输入用户名",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("手机号 "),(0,t.Wm)(g,{modelValue:h.QueryCondition.mobile,"onUpdate:modelValue":l[1]||(l[1]=e=>h.QueryCondition.mobile=e),placeholder:"请输入手机号码",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("邮箱 "),(0,t.Wm)(g,{modelValue:h.QueryCondition.email,"onUpdate:modelValue":l[2]||(l[2]=e=>h.QueryCondition.email=e),placeholder:"请输入邮箱",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",null,[(0,t.Uk)("所属项目 "),(0,t.Wm)(g,{modelValue:h.QueryCondition.project_name,"onUpdate:modelValue":l[3]||(l[3]=e=>h.QueryCondition.project_name=e),placeholder:"请输入项目名称",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,t._)("span",r,[(0,t.Wm)(f,{onClick:w.resetForm,icon:"el-icon-refresh"},{default:(0,t.w5)((()=>[(0,t.Uk)("重置")])),_:1},8,["onClick"]),(0,t.Wm)(f,{type:"success",onClick:w.submitForm,icon:"el-icon-refresh"},{default:(0,t.w5)((()=>[(0,t.Uk)(" 查询")])),_:1},8,["onClick"])])]),(0,t.Wm)(f,{onClick:w.clickAdd,plain:"",type:"success",icon:"el-icon-plus",style:{"margin-bottom":"5px","margin-left":"10px"}},{default:(0,t.w5)((()=>[(0,t.Uk)("新增用户")])),_:1},8,["onClick"]),(0,t.Wm)(U,{modelValue:h.addDlg,"onUpdate:modelValue":l[10]||(l[10]=e=>h.addDlg=e),title:"新增用户",width:"30%","custom-class":"class_dialog",required:!0,style:{"text-align":"left"},"before-close":w.clearValidation},{footer:(0,t.w5)((()=>[(0,t._)("span",d,[(0,t.Wm)(f,{onClick:w.clearValidation,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(f,{type:"success",onClick:w.AddInter,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(b,{model:h.addForm,rules:h.rulesUser,ref:"UserRef","label-width":"80px",style:{"max-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{label:"用户名"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.weChat_name,"onUpdate:modelValue":l[4]||(l[4]=e=>h.addForm.weChat_name=e),maxlength:"50",minlength:"1",placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{prop:"username",label:"登录账号"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.username,"onUpdate:modelValue":l[5]||(l[5]=e=>h.addForm.username=e),maxlength:"18",minlength:"3",placeholder:"请输入账号","show-word-limit":""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"手机号码",prop:"mobile"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.mobile,"onUpdate:modelValue":l[6]||(l[6]=e=>h.addForm.mobile=e),maxlength:"11",minlength:"11",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"邮箱地址"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.email,"onUpdate:modelValue":l[7]||(l[7]=e=>h.addForm.email=e),placeholder:"请输入邮箱地址",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"所属项目",required:!0,style:{"text-align":"left"}},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.project_name,"onUpdate:modelValue":l[8]||(l[8]=e=>h.addForm.project_name=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"密码",prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.addForm.password,"onUpdate:modelValue":l[9]||(l[9]=e=>h.addForm.password=e),type:"password","show-password":"",maxlength:"18",minlength:"3",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(U,{modelValue:h.editDlg,"onUpdate:modelValue":l[17]||(l[17]=e=>h.editDlg=e),title:"修改用户",width:"30%","custom-class":"class_dialog",required:!0,style:{"text-align":"left"},"before-close":w.clearValidation},{footer:(0,t.w5)((()=>[(0,t._)("span",n,[(0,t.Wm)(f,{type:"primary",onClick:w.resetPassword,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("重置密码")])),_:1},8,["onClick"]),(0,t.Wm)(f,{type:"success",onClick:w.UpdateInter,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"]),(0,t.Wm)(f,{onClick:w.clearValidation,size:"medium"},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"])])])),default:(0,t.w5)((()=>[(0,t.Wm)(b,{model:h.editForm,rules:h.rulesUser,ref:"UserRef","label-width":"80px",style:{"max-width":"500px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(_,{label:"用户名"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.weChat_name,"onUpdate:modelValue":l[11]||(l[11]=e=>h.editForm.weChat_name=e),maxlength:"50",minlength:"1",placeholder:"请输入名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{prop:"username",label:"登录账号"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.username,"onUpdate:modelValue":l[12]||(l[12]=e=>h.editForm.username=e),maxlength:"18",minlength:"3",placeholder:"请输入账号",disabled:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"手机号码",prop:"mobile"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.mobile,"onUpdate:modelValue":l[13]||(l[13]=e=>h.editForm.mobile=e),maxlength:"11",minlength:"11",placeholder:"请输入手机号"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"邮箱地址"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.email,"onUpdate:modelValue":l[14]||(l[14]=e=>h.editForm.email=e),placeholder:"请输入邮箱地址",maxlength:"30",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(_,{label:"所属项目",required:!0,style:{"text-align":"left"}},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.project_name,"onUpdate:modelValue":l[15]||(l[15]=e=>h.editForm.project_name=e),autocomplete:"off",disabled:""},null,8,["modelValue"])])),_:1}),h.showResetPassword?((0,t.wg)(),(0,t.j4)(_,{key:0,label:"新密码",prop:"password"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:h.editForm.password,"onUpdate:modelValue":l[16]||(l[16]=e=>h.editForm.password=e),type:"password","show-password":"",maxlength:"18",minlength:"3",placeholder:"请输入密码",readonly:"",onfocus:"this.removeAttribute('readonly');"},null,8,["modelValue"])])),_:1})):(0,t.kq)("",!0)])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,t._)("div",m,[(0,t.Wm)(y,{data:h.UserLsit,stripe:"","empty-text":"暂无数据"},{default:(0,t.w5)((()=>[(0,t.Wm)(V,{label:"序号",align:"center",width:"60"},{default:(0,t.w5)((e=>[(0,t._)("span",null,(0,o.zw)(e.$index+1),1)])),_:1}),(0,t.Wm)(V,{label:"登录账号",prop:"username",align:"center"}),(0,t.Wm)(V,{label:"用户名",prop:"weChat_name",align:"center"}),(0,t.Wm)(V,{label:"手机号码",prop:"mobile",align:"center"}),(0,t.Wm)(V,{label:"邮箱",prop:"email",align:"center"}),(0,t.Wm)(V,{label:"所属项目","show-overflow-tooltip":"",align:"center"},{default:(0,t.w5)((e=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.row.project,((l,a)=>((0,t.wg)(),(0,t.iD)("span",{key:a},[(0,t.Uk)((0,o.zw)(l.name)+" ",1),a!==e.row.project.length-1?((0,t.wg)(),(0,t.iD)("span",u,", ")):(0,t.kq)("",!0)])))),128))])),_:1}),(0,t.Wm)(V,{label:"创建时间",align:"center"},{default:(0,t.w5)((l=>[(0,t.Uk)((0,o.zw)(e.$tools.rTime(l.row.date_joined)),1)])),_:1}),(0,t.Wm)(V,{label:"操作",width:"180",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(f,{onClick:l=>w.clickEdit(e.row),size:"mini",plain:"",type:"success",icon:"el-icon-edit-outline"},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"]),(0,t.Wm)(f,{onClick:l=>w.delUser(e.row.id),size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])]),(0,t._)("div",c,[(0,t.Wm)(C,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,30,50,100],onSizeChange:w.sizes,onCurrentChange:w.currentPages,total:h.Pager.count,"current-page":h.Pager.current,"next-text":"下一页","prev-text":"上一页"},null,8,["onSizeChange","onCurrentChange","total","current-page"])])])),_:1})])}a(70560);var h=a(20065),w=(a(25341),{data(){return{UserLsit:"",QueryCondition:{username:"",mobile:"",email:"",project_name:""},Pager:"",addDlg:!1,addForm:{username:"",mobile:"",email:"",project_id:"",project_name:"",password:"",weChat_name:""},editDlg:!1,editForm:{username:"",mobile:"",email:"",project_id:"",project_name:"",password:"",weChat_name:""},showResetPassword:!1,rulesUser:{username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"}]}}},computed:{...(0,h.rn)(["pro","interfaces"]),...(0,h.Se)(["interfaces1","interfaces2"])},methods:{async getAllUser(e,l){const a=this.QueryCondition.username.trim(),t=this.QueryCondition.mobile.trim(),o=this.QueryCondition.email.trim(),s=this.QueryCondition.project_name.trim();let i=[];a&&i.push(`&username=${encodeURIComponent(a)}`),t&&i.push(`&mobile=${encodeURIComponent(t)}`),o&&i.push(`&email=${encodeURIComponent(o)}`),s&&i.push(`&project_name=${encodeURIComponent(s)}`);let r="/users/user/";e&&l||e?r+=`?page=${e}&size=${l}${i.join("")}`:l&&(r+=`?size=${l}${i.join("")}`);const d=await this.$api.getAlluser(r,this.pro.id);200===d.status&&(this.UserLsit=d.data.result,this.Pager=d.data)},resetForm(){this.QueryCondition.username="",this.QueryCondition.mobile="",this.QueryCondition.email="",this.QueryCondition.project_name="",console.log(this.interfaces)},submitForm(){this.getAllUser(1,this.Pager.size)},clickAdd(){this.addDlg=!0,this.addForm={username:"",mobile:"",email:"",password:"",project_id:this.pro.id,project_name:this.pro.name,weChat_name:""}},clearValidation(){this.addDlg=!1,this.editDlg=!1,this.showResetPassword=!1,this.$refs.UserRef.clearValidate()},AddInter(){this.$refs.UserRef.validate((async e=>{if(!e)return;const l={...this.addForm},a=await this.$api.createUser(l);201===a.status&&(this.$message({type:"success",message:"用户添加成功",duration:1e3}),this.addForm={username:"",mobile:"",email:"",password:"",project_id:"",project_name:"",weChat_name:""},this.addDlg=!1,this.showResetPassword=!1,this.getAllUser(1,this.Pager.size))}))},UpdateInter(){this.$refs.UserRef.validate((async e=>{if(!e)return;const l=this.editForm;console.log(l);const a=await this.$api.updateUser(l.id,l);200===a.status&&(this.$message({type:"success",message:"用户修改成功",duration:1e3}),this.addForm={username:"",mobile:"",email:"",password:"",project_id:"",project_name:"",weChat_name:""},this.editDlg=!1,this.showResetPassword=!1,this.getAllUser(1,this.Pager.size))}))},resetPassword(){this.showResetPassword=!this.showResetPassword,!1===this.showResetPassword&&(this.editForm.password="")},clickEdit(e){this.editDlg=!0,this.editForm={...e},this.editForm.project_id=this.pro.id,this.editForm.project_name=this.pro.name},delUser(e){this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const l=await this.$api.deleteUser(e);204===l.status&&(this.$message({type:"success",message:"删除成功!"}),this.getAllUser(1,this.Pager.size))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},currentPages(e){this.getAllUser(e,this.Pager.size),this.Pager.page=e,console.log(e)},sizes(e){this.getAllUser(1,e)}},created(){this.getAllUser(1,10)}}),g=a(40089);const f=(0,g.Z)(w,[["render",p],["__scopeId","data-v-ca357e2c"]]);var _=f}}]);
//# sourceMappingURL=805.41e34ff2.js.map