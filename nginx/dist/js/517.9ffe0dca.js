"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[517],{42517:function(e,a,l){l.r(a),l.d(a,{default:function(){return y}});var t=l(73396),o=l(87139);const n={slot:"footer",class:"dialog-footer",style:{"text-align":"center"}},i={slot:"footer",class:"dialog-footer",style:{"text-align":"center"}},r={slot:"footer",class:"dialog-footer",style:{"text-align":"center"}};function s(e,a,l,s,d,u){const c=(0,t.up)("el-button"),m=(0,t.up)("el-table-column"),p=(0,t.up)("el-switch"),b=(0,t.up)("el-tooltip"),h=(0,t.up)("el-table"),w=(0,t.up)("el-input"),T=(0,t.up)("el-form-item"),f=(0,t.up)("el-option"),g=(0,t.up)("el-select"),V=(0,t.up)("timerTaskCron"),y=(0,t.up)("el-popover"),D=(0,t.up)("el-form"),C=(0,t.up)("el-tab-pane"),W=(0,t.up)("el-cascader"),k=(0,t.up)("el-tabs"),_=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)(t.HY,null,[(0,t.Wm)(c,{onClick:a[0]||(a[0]=e=>d.addDialog=!0),style:{"margin-bottom":"30px","margin-left":"20px","margin-top":"25px"},type:"primary",icon:"el-icon-plus"},{default:(0,t.w5)((()=>[(0,t.Uk)("添加定时任务")])),_:1}),(0,t.Wm)(h,{data:d.cronList,style:{width:"100%"},size:"mini","empty-text":"暂无数据"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{label:"序号",align:"center",width:"60"},{default:(0,t.w5)((e=>[(0,t._)("span",null,(0,o.zw)(e.$index+1),1)])),_:1}),(0,t.Wm)(m,{prop:"name",label:"名称",align:"center"}),(0,t.Wm)(m,{prop:"plan_name",label:"执行任务",align:"center"}),(0,t.Wm)(m,{prop:"env_name",label:"执行环境",align:"center"}),(0,t.Wm)(m,{prop:"rule",label:"时间配置",align:"center"}),(0,t.Wm)(m,{label:"创建时间",align:"center"},{default:(0,t.w5)((a=>[(0,t.Uk)((0,o.zw)(e.$tools.rTime(a.row.create_time)),1)])),_:1}),(0,t.Wm)(m,{label:"是否开启",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(p,{onChange:a=>u.switchCronStatus(e.row),modelValue:e.row.status,"onUpdate:modelValue":a=>e.row.status=a,"active-color":"#13ce66","inactive-color":"#b1b1b1"},null,8,["onChange","modelValue","onUpdate:modelValue"])])),_:1}),(0,t.Wm)(m,{label:"操作",align:"center"},{default:(0,t.w5)((e=>[(0,t.Wm)(b,{class:"item",effect:"dark",content:"编辑",placement:"top"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{onClick:a=>u.showUpdateCronDlg(e.row),type:"primary",size:"mini",plain:"",icon:"el-icon-edit-outline"},{default:(0,t.w5)((()=>[(0,t.Uk)("编辑")])),_:2},1032,["onClick"])])),_:2},1024),(0,t.Wm)(b,{class:"item",effect:"dark",content:"删除",placement:"top"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{onClick:a=>u.delCron(e.row.id),type:"danger",size:"mini",plain:"",icon:"el-icon-delete"},{default:(0,t.w5)((()=>[(0,t.Uk)("删除")])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,t.Wm)(_,{modelValue:d.addDialog,"onUpdate:modelValue":a[20]||(a[20]=e=>d.addDialog=e),width:"50%",title:"新增定时执行任务","before-close":u.closeDialogCron,"custom-class":"class_dialog"},{default:(0,t.w5)((()=>[(0,t.Wm)(k,{type:"card",modelValue:d.currentTab,"onUpdate:modelValue":a[19]||(a[19]=e=>d.currentTab=e)},{default:(0,t.w5)((()=>[(0,t.Wm)(C,{label:"测试计划自动运行",name:"first"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{model:d.cronTabData,rules:d.rulescronTab,ref:"cronTabRef","label-width":"80px"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{label:"任务名称",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.name,"onUpdate:modelValue":a[1]||(a[1]=e=>d.cronTabData.name=e),placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"测试环境",prop:"env"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:d.cronTabData.env,"onUpdate:modelValue":a[2]||(a[2]=e=>d.cronTabData.env=e),placeholder:"请选择环境",style:{width:"100%"},"no-data-text":"暂无数据"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.testEnvs,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"时间配置",prop:"rule"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{visible:d.cronVisible,"onUpdate:visible":a[5]||(a[5]=e=>d.cronVisible=e),placement:"bottom-start",width:"30"},{reference:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.rule,"onUpdate:modelValue":a[3]||(a[3]=e=>d.cronTabData.rule=e),clearable:"",readonly:"",placeholder:"请选择时间配置",onClick:a[4]||(a[4]=e=>u.cronFun(d.currentTab))},null,8,["modelValue"])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{runTimeStr:d.cronTabData.rule,onCloseTime:u.closeRunTimeCron,onRunTime:u.runTimeCron},null,8,["runTimeStr","onCloseTime","onRunTime"])])),_:1},8,["visible"])])),_:1}),(0,t.Wm)(T,{label:"执行计划",prop:"plan"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{style:{width:"100%"},modelValue:d.cronTabData.plan,"onUpdate:modelValue":a[6]||(a[6]=e=>d.cronTabData.plan=e),placeholder:"请选择","no-data-text":"暂无数据"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.testPlans,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"是否开启"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:d.cronTabData.status,"onUpdate:modelValue":a[7]||(a[7]=e=>d.cronTabData.status=e),"active-color":"#13ce66","inactive-color":"#c3c3c3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,t._)("div",n,[(0,t.Wm)(c,{onClick:u.closeDialogCron},{default:(0,t.w5)((()=>[(0,t.Uk)("取 消")])),_:1},8,["onClick"]),(0,t.Wm)(c,{type:"primary",onClick:a[8]||(a[8]=e=>u.createCron(d.currentTab))},{default:(0,t.w5)((()=>[(0,t.Uk)("确 定")])),_:1})])])),_:1}),(0,t.Wm)(C,{label:"YApi自动导入",name:"second"},{default:(0,t.w5)((()=>[(0,t.Wm)(D,{model:d.cronTabData,rules:d.rulescronTab,ref:"cronTabRef","label-width":"100px"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{label:"任务名称",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.name,"onUpdate:modelValue":a[9]||(a[9]=e=>d.cronTabData.name=e),placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"时间配置",prop:"rule"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{visible:d.cronVisibleYApi,"onUpdate:visible":a[12]||(a[12]=e=>d.cronVisibleYApi=e),placement:"bottom-start",width:"30"},{reference:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.rule,"onUpdate:modelValue":a[10]||(a[10]=e=>d.cronTabData.rule=e),clearable:"",readonly:"",placeholder:"请选择时间配置",onClick:a[11]||(a[11]=e=>u.cronFun(d.currentTab))},null,8,["modelValue"])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{runTimeStr:d.cronTabData.rule,onCloseTime:u.closeRunTimeCron,onRunTime:u.runTimeCron},null,8,["runTimeStr","onCloseTime","onRunTime"])])),_:1},8,["visible"])])),_:1}),(0,t.Wm)(T,{label:"平台地址",prop:"url"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.url,"onUpdate:modelValue":a[13]||(a[13]=e=>d.cronTabData.yapi.url=e),placeholder:"请输入YApi平台项目地址",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"平台TOKEN",prop:"token"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.token,"onUpdate:modelValue":a[14]||(a[14]=e=>d.cronTabData.yapi.token=e),placeholder:"请输入YApi平台项目token",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"平台项目ID",prop:"YApiId"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.YApiId,"onUpdate:modelValue":a[15]||(a[15]=e=>d.cronTabData.yapi.YApiId=e),placeholder:"请输入YApi平台项目id",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"节点/模块",prop:"treenode"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:d.cronTabData.yapi.treenode,"onUpdate:modelValue":a[16]||(a[16]=e=>d.cronTabData.yapi.treenode=e),options:d.treeOptions,props:{label:"name",value:"id",checkStrictly:!0},onChange:u.removeCascaderAriaOwns,onVisibleChange:u.removeCascaderAriaOwns,onExpandChange:u.removeCascaderAriaOwns,clearable:"","change-on-select":"",filterable:"",placeholder:"请选择节点/模块"},null,8,["modelValue","options","onChange","onVisibleChange","onExpandChange"])])),_:1}),(0,t.Wm)(T,{label:"是否开启"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:d.cronTabData.status,"onUpdate:modelValue":a[17]||(a[17]=e=>d.cronTabData.status=e),"active-color":"#13ce66","inactive-color":"#c3c3c3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),(0,t._)("div",i,[(0,t.Wm)(c,{onClick:u.closeDialogCron},{default:(0,t.w5)((()=>[(0,t.Uk)("取 消")])),_:1},8,["onClick"]),(0,t.Wm)(c,{type:"primary",onClick:a[18]||(a[18]=e=>u.createCron(d.currentTab))},{default:(0,t.w5)((()=>[(0,t.Uk)("确 定")])),_:1})])])),_:1})])),_:1},8,["modelValue"])])),_:1},8,["modelValue","before-close"]),(0,t.Wm)(_,{modelValue:d.editDialog,"onUpdate:modelValue":a[37]||(a[37]=e=>d.editDialog=e),width:"50%",title:"修改定时执行任务","before-close":u.closeDialogCron,"custom-class":"class_dialog"},{default:(0,t.w5)((()=>[10===d.cronTabData.type?((0,t.wg)(),(0,t.j4)(D,{key:0,model:d.cronTabData,rules:d.rulescronTab,ref:"cronTabRef","label-width":"80px"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{label:"名称",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.name,"onUpdate:modelValue":a[21]||(a[21]=e=>d.cronTabData.name=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"测试环境",prop:"env"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{modelValue:d.cronTabData.env,"onUpdate:modelValue":a[22]||(a[22]=e=>d.cronTabData.env=e),placeholder:"请选择环境",style:{width:"100%"},"no-data-text":"暂无数据"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.testEnvs,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"时间配置"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{visible:d.cronVisibleEdit,"onUpdate:visible":a[25]||(a[25]=e=>d.cronVisibleEdit=e),placement:"bottom-start",width:"30"},{reference:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.rule,"onUpdate:modelValue":a[23]||(a[23]=e=>d.cronTabData.rule=e),clearable:"",readonly:"",placeholder:"请选择时间",onClick:a[24]||(a[24]=e=>u.cronFun(d.cronTabData.type))},null,8,["modelValue"])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{runTimeStr:d.cronTabData.rule,onCloseTime:u.closeRunTimeCron,onRunTime:u.runTimeCron},null,8,["runTimeStr","onCloseTime","onRunTime"])])),_:1},8,["visible"])])),_:1}),(0,t.Wm)(T,{label:"执行计划",prop:"plan"},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{style:{width:"100%"},modelValue:d.cronTabData.plan,"onUpdate:modelValue":a[26]||(a[26]=e=>d.cronTabData.plan=e),placeholder:"请选择","no-data-text":"暂无数据"},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(e.testPlans,(e=>((0,t.wg)(),(0,t.j4)(f,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"是否开启"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:d.cronTabData.status,"onUpdate:modelValue":a[27]||(a[27]=e=>d.cronTabData.status=e),"active-color":"#13ce66","inactive-color":"#c3c3c3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])):((0,t.wg)(),(0,t.j4)(D,{key:1,model:d.cronTabData,rules:d.rulescronTab,ref:"cronTabRef","label-width":"100px"},{default:(0,t.w5)((()=>[(0,t.Wm)(T,{label:"任务名称",prop:"name"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.name,"onUpdate:modelValue":a[28]||(a[28]=e=>d.cronTabData.name=e),placeholder:"请输入任务名称"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"时间配置",prop:"rule"},{default:(0,t.w5)((()=>[(0,t.Wm)(y,{visible:d.cronVisibleYApiEdit,"onUpdate:visible":a[31]||(a[31]=e=>d.cronVisibleYApiEdit=e),placement:"bottom-start",width:"30"},{reference:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.rule,"onUpdate:modelValue":a[29]||(a[29]=e=>d.cronTabData.rule=e),clearable:"",readonly:"",placeholder:"请选择时间配置",onClick:a[30]||(a[30]=e=>u.cronFun(d.cronTabData.type))},null,8,["modelValue"])])),default:(0,t.w5)((()=>[(0,t.Wm)(V,{runTimeStr:d.cronTabData.rule,onCloseTime:u.closeRunTimeCron,onRunTime:u.runTimeCron},null,8,["runTimeStr","onCloseTime","onRunTime"])])),_:1},8,["visible"])])),_:1}),(0,t.Wm)(T,{label:"平台地址",prop:"url"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.url,"onUpdate:modelValue":a[32]||(a[32]=e=>d.cronTabData.yapi.url=e),placeholder:"请输入YApi平台项目地址",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"平台TOKEN",prop:"token"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.token,"onUpdate:modelValue":a[33]||(a[33]=e=>d.cronTabData.yapi.token=e),placeholder:"请输入YApi平台项目token",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"平台项目ID",prop:"YApiId"},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{modelValue:d.cronTabData.yapi.YApiId,"onUpdate:modelValue":a[34]||(a[34]=e=>d.cronTabData.yapi.YApiId=e),placeholder:"请输入YApi平台项目id",clearable:""},null,8,["modelValue"])])),_:1}),(0,t.Wm)(T,{label:"节点/模块",prop:"treenode"},{default:(0,t.w5)((()=>[(0,t.Wm)(W,{modelValue:d.cronTabData.yapi.treenode,"onUpdate:modelValue":a[35]||(a[35]=e=>d.cronTabData.yapi.treenode=e),options:d.treeOptions,props:{label:"name",value:"id",checkStrictly:!0},onChange:u.removeCascaderAriaOwns,onVisibleChange:u.removeCascaderAriaOwns,onExpandChange:u.removeCascaderAriaOwns,clearable:"","change-on-select":"",filterable:"",placeholder:"请选择节点/模块"},null,8,["modelValue","options","onChange","onVisibleChange","onExpandChange"])])),_:1}),(0,t.Wm)(T,{label:"是否开启"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{modelValue:d.cronTabData.status,"onUpdate:modelValue":a[36]||(a[36]=e=>d.cronTabData.status=e),"active-color":"#13ce66","inactive-color":"#c3c3c3"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])),(0,t._)("div",r,[(0,t.Wm)(c,{onClick:u.closeDialogCron},{default:(0,t.w5)((()=>[(0,t.Uk)("取 消")])),_:1},8,["onClick"]),(0,t.Wm)(c,{type:"primary",onClick:u.UpdateCron},{default:(0,t.w5)((()=>[(0,t.Uk)("提交修改")])),_:1},8,["onClick"])])])),_:1},8,["modelValue","before-close"])],64)}const d={style:{display:"inline-block"}},u={class:"form"},c={class:"footer"};function m(e,a,l,n,i,r){const s=(0,t.up)("el-radio-button"),m=(0,t.up)("el-radio-group"),p=(0,t.up)("el-col"),b=(0,t.up)("el-time-picker"),h=(0,t.up)("el-row"),w=(0,t.up)("el-radio"),T=(0,t.up)("el-button");return(0,t.wg)(),(0,t.iD)("div",d,[(0,t._)("div",u,[(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[(0,t.Wm)(p,{span:60},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{modelValue:i.type,"onUpdate:modelValue":a[0]||(a[0]=e=>i.type=e),size:"large",style:{"margin-bottom":"20px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(s,{label:"每天"}),(0,t.Wm)(s,{label:"每周"}),(0,t.Wm)(s,{label:"每月"})])),_:1},8,["modelValue"])])),_:1}),(0,t.Wm)(p,{span:8,style:{"margin-left":"20px"}},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{modelValue:i.time,"onUpdate:modelValue":a[1]||(a[1]=e=>i.time=e),placeholder:"选择时间",size:"large",style:{width:"140px"},"value-format":"H:m"},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(h,null,{default:(0,t.w5)((()=>[i.weekRadio?((0,t.wg)(),(0,t.j4)(m,{key:0,modelValue:i.week,"onUpdate:modelValue":a[2]||(a[2]=e=>i.week=e)},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(i.weekOption,(e=>((0,t.wg)(),(0,t.j4)(w,{label:e.cron},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])):(0,t.kq)("",!0),i.monthRadio?((0,t.wg)(),(0,t.j4)(m,{key:1,modelValue:i.month,"onUpdate:modelValue":a[3]||(a[3]=e=>i.month=e),style:{width:"640px"}},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(i.monthOption,(e=>((0,t.wg)(),(0,t.j4)(w,{label:e.cron},{default:(0,t.w5)((()=>[(0,t.Uk)((0,o.zw)(e.value),1)])),_:2},1032,["label"])))),256))])),_:1},8,["modelValue"])):(0,t.kq)("",!0)])),_:1}),(0,t._)("div",c,[(0,t.Wm)(T,{size:"mini",type:"text",onClick:r.closeCron},{default:(0,t.w5)((()=>[(0,t.Uk)("取消")])),_:1},8,["onClick"]),(0,t.Wm)(T,{size:"mini",type:"primary",onClick:r.handleSummit},{default:(0,t.w5)((()=>[(0,t.Uk)("确定")])),_:1},8,["onClick"])])])])}l(70560);var p=l(44870),b={name:"timerTaskCron",props:{runTimeStr:(0,p.iH)(),timeCronStr:{type:String,default:""}},data(){return{visible:!1,weekRadio:!1,monthRadio:!1,value:"",type:"每天",week:1,month:1,time:"",weekOption:[{title:"星期一",value:"星期一",cron:1},{title:"星期二",value:"星期二",cron:2},{title:"星期三",value:"星期三",cron:3},{title:"星期四",value:"星期四",cron:4},{title:"星期五",value:"星期五",cron:5},{title:"星期六",value:"星期六",cron:6},{title:"星期日",value:"星期日",cron:7}],monthOption:[]}},watch:{type(e,a){"每天"===this.type&&(this.weekRadio=!1,this.monthRadio=!1),"每周"===this.type&&(this.weekRadio=!0,this.monthRadio=!1),"每月"===this.type&&(this.weekRadio=!1,this.monthRadio=!0)},week(e,a){},month(e,a){}},created(){this.initData()},mounted(){},methods:{initData(){let e=[];var a="";for(let l=1;l<32;l++)a=l<10?"  号":"号",e.push({title:l+a,value:l+a,cron:l});this.monthOption=e},closeCron(){this.$emit("closeTime",!1),this.type="每天",this.week=1,this.month=1,this.time=""},handleSummit(){if(!this.time)return void this.$message({message:"请选择时间!",type:"warning"});let e,a=this.time.split(":").reverse();"每天"===this.type&&(e=a.join(" ")+" * * *"),"每月"===this.type&&(e=a.join(" ")+" * "+this.month+" *"),"每周"===this.type&&(e=a.join(" ")+" "+this.week+" * *"),this.$emit("runTime",e),this.$emit("closeTime",!1),this.type="每天",this.week=1,this.month=1,this.time=""}}},h=l(40089);const w=(0,h.Z)(b,[["render",m],["__scopeId","data-v-19deff1e"]]);var T=w,f=l(20065),g={data(){return{currentTab:"first",treeOptions:[],cronVisible:!1,cronVisibleYApi:!1,cronVisibleEdit:!1,cronVisibleYApiEdit:!1,rulescronTab:{name:[{required:!0,message:"请输入名称",trigger:"blur"}],env:[{required:!0,message:"请选择环境",trigger:"blur"}],plan:[{required:!0,message:"请选择执行计划",trigger:"blur"}]},cronList:null,editDialog:!1,addDialog:!1,cronTabData:{name:"",status:!0,plan:null,env:null,rule:"",yapi:{token:"",YApiId:null,treenode:null,format:"list",project:null,url:"http://121.37.2.117:8081"},type:""}}},components:{timerTaskCron:T},computed:{...(0,f.rn)(["pro","testEnvs","testPlans"])},methods:{cronFun(e){"first"===e?this.cronVisible=!0:"second"===e?this.cronVisibleYApi=!0:10===e?this.cronVisibleEdit=!0:20===e?this.cronVisibleYApiEdit=!0:console.error("未知的值:",e)},closeRunTimeCron(e){this.cronVisible=e,this.cronVisibleYApi=e,this.cronVisibleEdit=e,this.cronVisibleYApiEdit=e},runTimeCron(e){this.cronTabData.rule=e},async getAllCron(){const e=await this.$api.getCrons(this.pro.id);200===e.status&&(this.cronList=e.data)},delCron(e){this.$confirm("此操作将永久删除该定时任务, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{const a=await this.$api.delCron(e);204===a.status&&(this.$message({type:"success",message:"删除成功!"}),this.getAllCron())})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},async switchCronStatus(e){const a=await this.$api.updateCron(e.id,e);200===a.status?1==e.status?this.$message({type:"success",message:"定时运行已开启",duration:1e3}):this.$message({type:"warning",message:"定时运行已关闭",duration:1e3}):this.$message({type:"error",message:"修改状态失败",duration:1e3})},closeDialogCron(){this.editDialog=!1,this.addDialog=!1,this.cronTabData={name:"",rule:"",status:!0,plan:null,env:null,yapi:{token:"",YApiId:null,treenode:null,format:"list",project:null,url:"http://121.37.2.117:8081"},type:null},this.$refs.cronTabRef.clearValidate()},async createCron(e){if("first"===e){delete this.cronTabData.yapi;const e={...this.cronTabData,type:10,project:this.pro.id},a=await this.$api.createCron(e);201===a.status&&(this.$message({type:"success",message:"定时任务添加成功",duration:1e3}),this.closeDialogCron(),this.getAllCron())}else if("second"===e){let e={...this.cronTabData.yapi};if(e.project=this.pro.id,e.treenode&&e.treenode.length>0){const a=e.treenode[e.treenode.length-1];e.treenode=a}const a={...this.cronTabData,project:this.pro.id,yapi:e,type:20};console.log(a);const l=await this.$api.createCron(a);201===l.status&&(this.$message({type:"success",message:"定时任务添加成功",duration:1e3}),this.closeDialogCron(),this.getAllCron())}else console.log("待完善")},showUpdateCronDlg(e){this.cronTabData=JSON.parse(JSON.stringify(e)),this.editDialog=!0},async UpdateCron(){let e={...this.cronTabData.yapi};if(e.project=this.pro.id,e.treenode&&e.treenode.length>0){const a=e.treenode[e.treenode.length-1];e.treenode=a}const a={...this.cronTabData,yapi:e};console.log(a);const l=await this.$api.updateCron(this.cronTabData.id,a);200===l.status&&(this.$message({type:"success",message:"修改成功",duration:1e3}),this.closeDialogCron(),this.getAllCron())},removeCascaderAriaOwns(){this.$nextTick((()=>{const e=document.querySelectorAll(".el-cascader-panel .el-cascader-node[aria-owns]");Array.from(e).map((e=>e.removeAttribute("aria-owns")))}))},async allTree(){const e=await this.$api.gettreeNode();200===e.status&&(this.treeOptions=e.data.result)}},created(){this.getAllCron(),this.allTree()}};const V=(0,h.Z)(g,[["render",s]]);var y=V}}]);
//# sourceMappingURL=517.9ffe0dca.js.map