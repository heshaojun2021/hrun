"use strict";(self["webpackChunkfrontend_web"]=self["webpackChunkfrontend_web"]||[]).push([[341],{25341:function(e,l,t){t.r(l),t.d(l,{default:function(){return F}});var a=t(73396),o=t(87139);const i={class:"title"},n={class:"query_model"},d={class:"buttons"},r={style:{"font-weight":"bold"}},s={key:0},m={key:1},c={key:2},u={key:3},p={key:4},f={key:5},h={style:{"font-weight":"bold"}},w={key:0},g={key:1},k={key:2},b={key:3},_={key:4},y={key:5},W={class:"demo-pagination-block"},D={key:0},U={class:"dialog-footer"},C={key:0},v={class:"dialog-footer"};function z(e,l,t,z,V,T){const E=(0,a.up)("el-input"),I=(0,a.up)("el-button"),x=(0,a.up)("el-table-column"),F=(0,a.up)("el-tag"),P=(0,a.up)("el-table"),q=(0,a.up)("el-tab-pane"),A=(0,a.up)("el-pagination"),Q=(0,a.up)("el-tabs"),L=(0,a.up)("el-form-item"),$=(0,a.up)("el-tooltip"),S=(0,a.up)("el-option"),j=(0,a.up)("el-select"),H=(0,a.up)("el-form"),R=(0,a.up)("el-dialog"),G=(0,a.Q2)("loading");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",i,[(0,a.Wm)(Q,{type:"card",class:"demo-tabs",onTabClick:T.handleTabClick,modelValue:V.activeName,"onUpdate:modelValue":l[3]||(l[3]=e=>V.activeName=e),style:{height:"calc(100vh - 65px)"}},{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a._)("span",null,[(0,a.Uk)("接口名称 "),(0,a.Wm)(E,{modelValue:V.QueryCondition.name,"onUpdate:modelValue":l[0]||(l[0]=e=>V.QueryCondition.name=e),placeholder:"请输入接口名称",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,a._)("span",null,[(0,a.Uk)("请求类型 "),(0,a.Wm)(E,{modelValue:V.QueryCondition.method,"onUpdate:modelValue":l[1]||(l[1]=e=>V.QueryCondition.method=e),placeholder:"请输入请求类型",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,a._)("span",null,[(0,a.Uk)("接口地址 "),(0,a.Wm)(E,{modelValue:V.QueryCondition.url,"onUpdate:modelValue":l[2]||(l[2]=e=>V.QueryCondition.url=e),placeholder:"请输入接口地址",autocomplete:"off",maxlength:"30",clearable:!0,style:{width:"200px"}},null,8,["modelValue"])]),(0,a._)("span",d,[(0,a.Wm)(I,{onClick:T.resetForm,icon:"el-icon-refresh"},{default:(0,a.w5)((()=>[(0,a.Uk)("重置")])),_:1},8,["onClick"]),(0,a.Wm)(I,{type:"success",onClick:T.submitForm,icon:"el-icon-refresh"},{default:(0,a.w5)((()=>[(0,a.Uk)(" 查询")])),_:1},8,["onClick"])])]),(0,a.Wm)(q,{label:"项目接口",name:"first"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{onClick:T.clickAdd,plain:"",type:"success",icon:"el-icon-plus",style:{"margin-bottom":"5px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("添加接口")])),_:1},8,["onClick"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(P,{data:V.interfaceData.result,"empty-text":"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"序号",align:"center",width:"60"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,o.zw)(e.$index+1),1)])),_:1}),(0,a.Wm)(x,{label:"接口名称",prop:"name",align:"center"}),(0,a.Wm)(x,{label:"请求类型",align:"center",width:"100"},{default:(0,a.w5)((e=>[(0,a._)("div",r,["POST"===e.row.method?((0,a.wg)(),(0,a.iD)("span",s,[(0,a.Wm)(F,{color:"#49cc90",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"GET"===e.row.method?((0,a.wg)(),(0,a.iD)("span",m,[(0,a.Wm)(F,{color:"#61affe",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"PUT"===e.row.method?((0,a.wg)(),(0,a.iD)("span",c,[(0,a.Wm)(F,{color:"#fca130",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"PATCH"===e.row.method?((0,a.wg)(),(0,a.iD)("span",u,[(0,a.Wm)(F,{color:"#50e3c2",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"DELETE"===e.row.method?((0,a.wg)(),(0,a.iD)("span",p,[(0,a.Wm)(F,{color:"#f56c6c",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"DEAD"===e.row.method?((0,a.wg)(),(0,a.iD)("span",f,[(0,a.Wm)(F,{color:"rgb(201, 233, 104)",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(x,{label:"接口地址",prop:"url","show-overflow-tooltip":"",align:"center"}),(0,a.Wm)(x,{label:"创建时间",align:"center"},{default:(0,a.w5)((l=>[(0,a.Uk)((0,o.zw)(e.$tools.rTime(l.row.create_time)),1)])),_:1}),(0,a.Wm)(x,{label:"操作",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(I,{onClick:l=>T.clickEdit(e.row),size:"mini",plain:"",type:"success",icon:"el-icon-edit-outline"},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(I,{onClick:l=>T.clickDel(e.row.id)(),size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[G,V.isLoading]])])),_:1}),(0,a.Wm)(q,{label:"外部接口",name:"second"},{default:(0,a.w5)((()=>[(0,a.Wm)(I,{onClick:T.clickAdd,plain:"",type:"success",icon:"el-icon-plus",style:{"margin-bottom":"5px"}},{default:(0,a.w5)((()=>[(0,a.Uk)("添加接口")])),_:1},8,["onClick"]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(P,{data:V.interfaceData.result,"empty-text":"暂无数据"},{default:(0,a.w5)((()=>[(0,a.Wm)(x,{label:"序号",align:"center",width:"60"},{default:(0,a.w5)((e=>[(0,a._)("span",null,(0,o.zw)(e.$index+1),1)])),_:1}),(0,a.Wm)(x,{label:"接口名称",prop:"name",align:"center"}),(0,a.Wm)(x,{label:"请求类型",align:"center",width:"100"},{default:(0,a.w5)((e=>[(0,a._)("div",h,["POST"===e.row.method?((0,a.wg)(),(0,a.iD)("span",w,[(0,a.Wm)(F,{color:"#49cc90",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"GET"===e.row.method?((0,a.wg)(),(0,a.iD)("span",g,[(0,a.Wm)(F,{color:"#61affe",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"PUT"===e.row.method?((0,a.wg)(),(0,a.iD)("span",k,[(0,a.Wm)(F,{color:"#fca130",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"PATCH"===e.row.method?((0,a.wg)(),(0,a.iD)("span",b,[(0,a.Wm)(F,{color:"#50e3c2",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"DELETE"===e.row.method?((0,a.wg)(),(0,a.iD)("span",_,[(0,a.Wm)(F,{color:"#f93e3e",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0),"DEAD"===e.row.method?((0,a.wg)(),(0,a.iD)("span",y,[(0,a.Wm)(F,{color:"rgb(201, 233, 104)",size:"large"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,o.zw)(e.row.method),1)])),_:2},1024)])):(0,a.kq)("",!0)])])),_:1}),(0,a.Wm)(x,{label:"接口地址",prop:"url","show-overflow-tooltip":"",align:"center"}),(0,a.Wm)(x,{label:"创建时间",align:"center"},{default:(0,a.w5)((l=>[(0,a.Uk)((0,o.zw)(e.$tools.rTime(l.row.create_time)),1)])),_:1}),(0,a.Wm)(x,{label:"操作",align:"center"},{default:(0,a.w5)((e=>[(0,a.Wm)(I,{onClick:l=>T.clickEdit(e.row),size:"mini",plain:"",type:"success",icon:"el-icon-edit-outline"},{default:(0,a.w5)((()=>[(0,a.Uk)("编辑")])),_:2},1032,["onClick"]),(0,a.Wm)(I,{onClick:l=>T.clickDel(e.row.id)(),size:"mini",type:"danger",plain:"",icon:"el-icon-delete"},{default:(0,a.w5)((()=>[(0,a.Uk)("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])),[[G,V.isLoading]])])),_:1}),(0,a._)("div",W,[(0,a.Wm)(A,{background:"",layout:"total, sizes, prev, pager, next, jumper","page-sizes":[10,30,50,100],onSizeChange:T.sizes,onCurrentChange:T.currentPages,total:V.interfaceData.count,"current-page":V.interfaceData.current,"next-text":"下一页","prev-text":"上一页"},null,8,["onSizeChange","onCurrentChange","total","current-page"])])])),_:1},8,["onTabClick","modelValue"])]),(0,a.Wm)(R,{modelValue:V.addDlg,"onUpdate:modelValue":l[8]||(l[8]=e=>V.addDlg=e),title:"添加接口",width:"40%","before-close":T.clickClear},{footer:(0,a.w5)((()=>[(0,a._)("span",U,[(0,a.Wm)(I,{onClick:T.clickClear},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1},8,["onClick"]),(0,a.Wm)(I,{type:"success",onClick:T.addInter},{default:(0,a.w5)((()=>[(0,a.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(H,{model:V.addForm,rules:V.rulesinterface,ref:"interfaceRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{label:"接口名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:V.addForm.name,"onUpdate:modelValue":l[4]||(l[4]=e=>V.addForm.name=e),autocomplete:"off",placeholder:"请输入接口名称"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"URL地址",prop:"url"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:V.addForm.url,"onUpdate:modelValue":l[5]||(l[5]=e=>V.addForm.url=e),autocomplete:"off",placeholder:"请输入接口"},{prepend:(0,a.w5)((()=>[this.envUrl.length<25?((0,a.wg)(),(0,a.iD)("span",D,(0,o.zw)(this.envUrl),1)):((0,a.wg)(),(0,a.j4)($,{key:1,effect:"dark",content:this.envUrl,placement:"top-start"},{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,o.zw)(this.envUrl.slice(0,12))+"...",1)])),_:1},8,["content"]))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"请求类型",prop:"method"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{style:{width:"100%"},modelValue:V.addForm.method,"onUpdate:modelValue":l[6]||(l[6]=e=>V.addForm.method=e),class:"m-2",placeholder:"请选择请求类型"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{label:"GET",value:"GET"}),(0,a.Wm)(S,{label:"POST",value:"POST"}),(0,a.Wm)(S,{label:"PUT",value:"PUT"}),(0,a.Wm)(S,{label:"PATCH",value:"PATCH"}),(0,a.Wm)(S,{label:"DELETE",value:"DELETE"}),(0,a.Wm)(S,{label:"DEAD",value:"DEAD"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"接口类型",prop:"type"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{style:{width:"100%"},modelValue:V.addForm.type,"onUpdate:modelValue":l[7]||(l[7]=e=>V.addForm.type=e),class:"m-2",placeholder:"请选择接口"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{label:"项目接口",value:"1"}),(0,a.Wm)(S,{label:"第三方接口",value:"2"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"]),(0,a.Wm)(R,{modelValue:V.editDlg,"onUpdate:modelValue":l[13]||(l[13]=e=>V.editDlg=e),title:"修改接口",width:"40%","before-close":T.clickClear},{footer:(0,a.w5)((()=>[(0,a._)("span",v,[(0,a.Wm)(I,{onClick:T.clickClear},{default:(0,a.w5)((()=>[(0,a.Uk)("取消")])),_:1},8,["onClick"]),(0,a.Wm)(I,{type:"success",onClick:T.updateInter},{default:(0,a.w5)((()=>[(0,a.Uk)("确定")])),_:1},8,["onClick"])])])),default:(0,a.w5)((()=>[(0,a.Wm)(H,{model:V.editForm,rules:V.rulesinterface,ref:"interfaceRef"},{default:(0,a.w5)((()=>[(0,a.Wm)(L,{label:"接口名称",prop:"name"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:V.editForm.name,"onUpdate:modelValue":l[9]||(l[9]=e=>V.editForm.name=e),modelModifiers:{trim:!0},autocomplete:"off"},null,8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"URL地址",prop:"url"},{default:(0,a.w5)((()=>[(0,a.Wm)(E,{modelValue:V.editForm.url,"onUpdate:modelValue":l[10]||(l[10]=e=>V.editForm.url=e),autocomplete:"off",placeholder:"请输入接口"},{prepend:(0,a.w5)((()=>[this.envUrl.length<25?((0,a.wg)(),(0,a.iD)("span",C,(0,o.zw)(this.envUrl),1)):((0,a.wg)(),(0,a.j4)($,{key:1,effect:"dark",content:this.envUrl,placement:"top-start"},{default:(0,a.w5)((()=>[(0,a._)("span",null,(0,o.zw)(this.envUrl.slice(0,12))+"...",1)])),_:1},8,["content"]))])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"请求类型",prop:"method"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{style:{width:"100%"},modelValue:V.editForm.method,"onUpdate:modelValue":l[11]||(l[11]=e=>V.editForm.method=e),class:"m-2",placeholder:"请求选择请求类型",size:"large"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{label:"GET",value:"GET"}),(0,a.Wm)(S,{label:"POST",value:"POST"}),(0,a.Wm)(S,{label:"PUT",value:"PUT"}),(0,a.Wm)(S,{label:"PATCH",value:"PATCH"}),(0,a.Wm)(S,{label:"DELETE",value:"DELETE"}),(0,a.Wm)(S,{label:"DEAD",value:"DEAD"})])),_:1},8,["modelValue"])])),_:1}),(0,a.Wm)(L,{label:"接口类型",prop:"type"},{default:(0,a.w5)((()=>[(0,a.Wm)(j,{style:{width:"100%"},modelValue:V.editForm.type,"onUpdate:modelValue":l[12]||(l[12]=e=>V.editForm.type=e),class:"m-2",placeholder:"选择接口",size:"large"},{default:(0,a.w5)((()=>[(0,a.Wm)(S,{label:"项目接口",value:"1"}),(0,a.Wm)(S,{label:"第三方接口",value:"2"})])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","before-close"])],64)}var V=t(20065),T=t(37046),E={data(){return{rulesinterface:{name:[{required:!0,message:"请输入接口名称",trigger:"blur"}],url:[{required:!0,message:"请输入接口信息",trigger:"blur"}],method:[{required:!0,message:"请选择请求类型",trigger:"blur"}],type:[{required:!0,message:"请选择接口类型",trigger:"blur"}]},activeName:"first",QueryCondition:{name:"",method:"",url:""},isLoading:"",interfaceData:"",tabIndex:"",envUrl:"",addDlg:!1,addForm:{name:"",url:"",method:"",type:null,project:""},editDlg:!1,editForm:{name:"",url:"",method:"",type:null,project:""}}},computed:{...(0,V.rn)(["pro","envId","interfaces"]),...(0,V.Se)(["interfaces1","interfaces2"])},methods:{...(0,V.nv)(["getAllInter"]),handleTabClick(e){"0"===e.index?(this.allInterface(1,1,this.interfaceData.size),this.tabIndex=1):(this.allInterface(2,1,this.interfaceData.size),this.tabIndex=2)},clickAdd(){this.checkEnvDetail(),this.addDlg=!0,this.addForm={name:"",url:"",method:"",type:null,project:this.pro.id}},clickEdit(e){this.checkEnvDetail(),this.editDlg=!0,this.editForm={...e}},clickClear(){this.editDlg=!1,this.addDlg=!1,this.$refs.interfaceRef.clearValidate()},resetForm(){this.QueryCondition.name="",this.QueryCondition.method="",this.QueryCondition.url=""},submitForm(){this.allInterface()},clickDel(e){T.T$.confirm("确定要删除该接口吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.delInter(e)})).catch((()=>{(0,T.z8)({type:"info",message:"取消删除",duration:1e3})}))},async allInterface(e=1,l,t){this.isLoading=!0;const a=this.QueryCondition.name.trim(),o=this.QueryCondition.method.trim(),i=this.QueryCondition.url.trim();let n={};""!==a&&(n.name=a),""!==o&&(n.method=o),""!==i&&(n.url=i);const d=await this.$api.getInterfaces(this.pro.id,e,l,t,n.name,n.method,n.url);200===d.status&&(this.interfaceData=d.data),this.isLoading=!1},async addInter(){this.$refs.interfaceRef.validate((async e=>{if(!e)return;const l=await this.$api.createInterface(this.addForm);201===l.status&&((0,T.z8)({type:"success",message:"添加成功",duration:1e3}),this.addDlg=!1,this.allInterface(this.tabIndex))}))},async updateInter(){this.$refs.interfaceRef.validate((async e=>{if(!e)return;const l=await this.$api.updateInterface(this.editForm.id,this.editForm);200===l.status&&((0,T.z8)({type:"success",message:"修改成功",duration:1e3}),this.editDlg=!1,this.allInterface(this.tabIndex))}))},async delInter(e){const l=await this.$api.delInterface(e);204===l.status&&((0,T.z8)({type:"success",message:"删除成功",duration:1e3}),this.allInterface(this.tabIndex))},async checkEnvDetail(){const e=await this.$api.getEnvInfo(this.envId,this.pro.id);200===e.status&&(this.envUrl=e.data.debug_global_variable.host)},currentPages(e){this.allInterface(this.tabIndex,e,this.interfaceData.size),this.interfaceData.page=e},sizes(e){setTimeout((()=>{this.allInterface(this.tabIndex,1,e)}),500)}},created(){this.allInterface(),this.tabIndex=1}},I=t(40089);const x=(0,I.Z)(E,[["render",z],["__scopeId","data-v-af3780a6"]]);var F=x}}]);
//# sourceMappingURL=341.3d38c41b.js.map